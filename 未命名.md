我们假设：捕食关系对种群数量的影响和合作-竞争对种群数量的影响比值为0.7和0.3，其中被捕食和捕食的影响占整个捕食关系的一半
那么可以写出这样一个总的模型：

对于一个物种的种群数量$x_i(t)$，设捕食关系中其属于营养级为$X_1(t)=(x_1(t),x_2(t), \cdots,x_i(t),\cdots, x_m(t))$，相应的捕食者为$Y(t)=(y_1(t),y_2(t),\cdots,y_m(t))$
可能存在的被捕食者为$M(t)=(m_1(t),m_2(t),\cdots, m_m(t))$

设合作-竞争关系中其属于$X_2(t)=(x_1(t),x_2(t), \cdots,x_i(t),\cdots, x_n(t))$，相应的竞争者或合作者为$Z(t)=(z_1(t), z_2(t), \cdots, z_n(t))$

则有生产者（只被捕食，不捕食）种群数量：
$$\begin{align}
\frac{dX(t)}{dt}&=0.7\cdot[ X(t)(\alpha_x​\cdot S(t)−F(X(t))\cdot S(t)\cdot X(t))(1-\frac{X(t)}{K_1\cdot S(t)})]\\ &+0.3\cdot[X(t)(\alpha_x\cdot S(t)-\beta_1Y(t)+\omega_1Y(t))(1-\frac{X(t)}{K_1\cdot S(t)})]+\sigma​X(t)W(t)
\end{align}$$

初级捕食者（可能捕食，可能被捕食）：
$$\begin{align}
\frac{dX(t)}{dt}&=0.35\cdot[ X(t)(\alpha_x​\cdot S(t)−F_1(X(t))\cdot S(t)\cdot X(t))(1-\frac{X(t)}{K_1\cdot S(t)})\\
&+X(t)(-\alpha_x\cdot S(t)+e\cdot F_2(X(t))\cdot​M(t))(1-\frac{X(t)}{K_1})]\\ &+0.3\cdot[X(t)(\alpha_x\cdot S(t)-\beta_1Y(t)+\omega_1Y(t))(1-\frac{X(t)}{K_1\cdot S(t)})] +\sigma X(t)W(t)
\end{align}$$

次级捕食者（在我们的模型中为顶级捕食者）（只捕食）：
$$\begin{align}
\frac{dX(t)}{dt}&=0.7\cdot[
X(t)(-\alpha_x\cdot S(t)+e\cdot F(X(t))\cdot S(t)\cdot M(t))(1-\frac{X(t)}{K_1})]\\ &+0.3\cdot[X(t)(\alpha_x\cdot S(t)-\beta_1Y(t)+\omega_1Y(t))(1-\frac{X(t)}{K_1\cdot S(t)})] +\sigma X(t)W(t)
\end{align}$$

上面的公式中：
- $\beta$表示两个物种之间的竞争效应强度，大于等于0，小于等于1
- $\omega$表示两个物种之间的合作效应强度，大于等于0
- $\alpha$表示两个物种自然情况下的增长率（注意不是死亡率）
- $e$表示捕食的猎物与新生捕食者的比率，即“捕食多少猎物，才能诞生一个捕食者”
- $F(X(t))=\frac{aX(t)}{1+ahX(t)}$为捕食响应函数
- $\sigma$衡量受环境影响的程度
- $W(t)$为随机扰动
- $S(t)=1+\sin(\frac{2\pi t}{T}+\phi)$是季节影响因子函数


以下面的各个种群及其对应关系为基础，建立仿真程序：

1. 作物种群
   属于：生产者类
   捕食者：害虫
   被捕食者：无
   合作关系：蝙蝠、益虫
   竞争关系：其他生产者

2. 其他生产者
   属于：生产者类
   捕食者：害虫
   被捕食者：无
   合作关系：蝙蝠、益虫
   竞争关系：作物

3. 害虫
   属于：初级捕食者类
   捕食者：蝙蝠、其他次级捕食者
   被捕食者：作物、其他生产者
   合作关系：无
   竞争关系：种内竞争

4. 益虫
   属于：初级捕食者类
   捕食者：其他次级捕食者
   被捕食者：无
   合作关系：作物、其他生产者、蝙蝠
   竞争关系：害虫

5. 蝙蝠：
   属于：次级捕食者类
   捕食者：无
   被捕食者：害虫
   合作关系：作物、其他生产者
   竞争关系：其他次级捕食者

6. 其他次级捕食者：
   属于：次级捕食者类
   捕食者：无
   被捕食者：害虫、益虫
   合作关系：无
   竞争关系：蝙蝠




$f$是农业周期影响函数，设一个农业周期时间为T，$P(t,K_1,X_i(t),\cdots)=\frac{dX_{原i}(t)}{dt}$为不考虑农业周期影响情况下的种群数量增长公式，其中t为时间，$K_1$为生态承载量；$X_i(t)$为所有种群中特定种群的种群数量，$i=1,2,3,4,5,6$
$$ X_i(t):\begin{cases}
作物种群的种群数量,\quad i=1\\
其他生产者的种群数量,\quad i=2\\
害虫的种群数量,\quad i=3\\
益虫的种群数量,\quad i=4\\
蝙蝠的种群数量,\quad i=5\\
其他次级捕食者的种群数量,\quad i=6
\end{cases}
$$
设$K(K_1,n)=K_1+\frac{K_{max}-K_0}{1+e^{-n}}$为农业周期对生态承载力的影响函数
$D(t)=\frac{D_0}{1+e^{-k_d(u(t)-u_m)}}$为化学药剂的影响函数，其中：
- $k_d$为控制影响显著程度的因子，可以假设为1
- $D_0$为最大影响程度，化学药剂对各个物种均有影响，但是影响程度不同，通过这个值来控制
- $u_m$是开始生效的剂量
- $u(t)$是剂量控制函数，也就是对使用化学药剂的决策函数，之后的决策有效性依靠改变这个函数来观察哪种策略更好

则：
$$ f(P(t,K_1,X_i(t),\cdots))=\begin{cases}
P(t,K(K_1,n),X_i(t),\cdots),同时令P(t,K_1,X_i(t),\cdots)=f(P(t,K_1,X_i(t),\cdots)), \quad当nT+t_1\leq t < (n+1)T+t_1，且i=1或2，其中n是经过的农业周期数，t_1是土壤准备阶段开始时刻\\
P(t,K_1,X_i(t),\cdots)-X(t)\cdot D_i(t),同时令P(t,K_1,X_i(t),\cdots)=f(P(t,K_1,X_i(t),\cdots)),\quad当nT+t_2\leq t\leq nT+t_3,其中t_2是防治阶段开始时刻，t_3是收获阶段开始时刻，D_i(t)为种群对应的化学药剂影响函数\\
P(t,K(K_1,n),0.1X_i(t),\cdots),同时令P(t,K_1,X_i(t),\cdots)=f(P(t,K_1,X_i(t),\cdots)),\quad 当t=nT+t_3,且i=1\\
P(t,K_1,X_i(t),\cdots),\quad 其他
\end{cases}$$
