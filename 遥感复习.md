# C1. 遥感物理基础
## 1. 电磁波与电磁辐射
$$电磁波\begin{cases}
是横波\\
在真空中以光速传播\\
具有波粒二象性 \begin{cases}
波动性\begin{cases}
干涉\\
衍射\\
偏振
\end{cases}\\
粒子性——光子/量子
\end{cases}
\end{cases}
$$
在平面波内，电场和磁场的振动方向都是在与波的行进方向成直角的平面内，且两个平面互相垂直。
电磁波的波长$\lambda$、频率v和光速c之间的关系为
$$ \lambda = c / v$$
### 1.1 波动性
$$\Psi = A*\sin[(\omega t - kx)+\phi_0]$$
其中$\Psi$为波函数（电场强度/磁场强度），$\omega$为角频率，A为振幅，$k=2\pi/\lambda$，t为时间变量，x为空间变量，$\phi_0$为初相位

- 干涉现象：**同振幅、频率和初相位的多列波叠加合成而引起振动强度重新分布的现象**。波的叠加区内振动强度在空间中出现强弱相间的固定分布，形成干涉条纹

- 衍射现象：波在传播过程中遇到障碍物时**在其边缘偏离直线传播**，进入障碍物后面的“阴影区”的现象

- 偏振现象：电磁波由相互垂直的电场矢量E和磁场强度矢量H来表征，E和H都与电磁波的传播方向垂直。**若电场矢量E在一个固定平面内沿着一个固定方向振动，就称该电磁波是偏振的**，该平面叫做偏振平面

### 1.2 粒子性
电磁辐射的实质是光子微粒流的有规律的运动，光子的能量可表示为：
$$ E=hv,\quad h=6.626\times 10^{-34}J*s$$
v为频率。由于$\lambda = c/v$，所以又有：
$$ E=hc/\lambda$$
这说明：**辐射能量与其波长成反比，电磁辐射波长越长，辐射能量越小**，因此波长较长的微波辐射要比波长较短的热红外辐射更难感应

频率（波长）也对应于可见光领域中目标物体的颜色，包含了与目标物体有关的丰富信息

## 2. 电磁波谱
遥感中常用的电磁波波段：

|     | 波段名称     | 波长范围                                                              | 主要来源及性质                                               | 用途                        |
| --: | -------- | ----------------------------------------------------------------- | ----------------------------------------------------- | ------------------------- |
|     | 紫外线（UV）  | $0.01\sim 0.4\mu m$                                               | 太阳辐射，但$0.3\mu m$以下的紫外线几乎全被吸收，其余被大量散射，因此能量很少           | 碳酸盐岩分布、水面油污染探测            |
|     | 可见光      | $0.4\sim 0.76\mu m$                                               | 太阳辐射能量高度集中，可被人眼直接感受并区分单色光                             | 是鉴别物质特征的最佳波段，也是遥感最常用的波段   |
| 红外线 | 近红外与短波红外 | $0.76\sim1.3\sim 3.0\mu m$                                        | 主要来自地球反射太阳的红外辐射（**反射红外**）。由于波长较长，不容易受到大气散射的影响，适合远距离探测 | 鉴别地物：植被和水体                |
| 红外线 | 热红外      | 中红外$3.0\sim 6.0\mu m$；远红外$6.0\sim15.0\mu m$；超远红外$15\sim1000\mu m$ | 主要来自地球自身的热辐射，因此称为热红外                                  | 热红外遥感探测地物，穿透烟雾能力强         |
|     | 微波       | $1mm\sim 1m$                                                      | 波长比可见光和红外线都长，能穿透大气层和厚云层而不受天气影响，因此适合全天候全天时遥感探测         | 全天候遥感探测，并且可以选择采取主动或被动方式成像 |

## 3. 辐射源
### 3.1 自然辐射源
#### 1. 太阳辐射
太阳辐射能量**在各个光谱段的分配非常不平衡**，主要集中在近紫外-中红外的波谱区间内，可见光和红外光占大部分。因此**太阳辐射属于短波辐射，是可见光及近红外遥感中主要的辐射源**

由于**大气吸收、散射和反射的影响，最终到达地球表面上的太阳辐射强度出现明显衰减**

#### 2. 地球辐射
地球表面地物不仅具有反射太阳辐射的能力，还具有**向外辐射电磁波的能力**：地球辐射近似为温度为300K的黑体辐射，**是红外遥感的主要辐射源**

地球辐射传播的过程中仍然受大气的吸收作用等影响，造成辐射能量有所衰减

### 3.2 人工辐射源
#### 1. 微波辐射源
微波遥感常用的波段为$0.8\sim30cm$，波长比可见光和红外线要长，技术上主要使用光电技术。在微波遥感一章再谈

#### 2. 激光辐射源
使用气体、液体、固体、半导体、化学等各种类型的激光器发射激光，光谱范围较长：$0.24\mu m \sim 1000\mu m$均有，例如激光雷达

## 4. 电磁辐射的度量
### 4.1 辐射能量
以电磁波形式向外传送的能量大小，用W或Q表示，单位为焦耳J

### 4.2 辐射通量
也称**辐射功率**，$\Phi=\mathrm{d}W/\mathrm{d}t$，代表**单位时间内通过某一表面的辐射能量，单位为瓦W**

### 4.3 辐射通量密度（辐射照度和辐射出射度）
辐射通量密度E指的是**单位面积上的辐射通量**，根据物体是被辐射还是辐射，又细分为辐射照度I和辐射出射度M

- 辐射照度I：**被辐射的物体**表面单位面积上的辐射通量，$I=\mathrm{d}\Phi / \mathrm{d}S$
- 辐射出射度M：**温度为T的辐射源物体**表面单位面积上的辐射通量，$M=\mathrm{d}\Phi/\mathrm{d}S$
单位均为$W/m^2$，S是面积

### 4.4 辐射强度
用于**描述点辐射源的辐射特性**。指的是点辐射源**在某一方向上单位立体角内发出的辐射通量**：
$$ I_{\lambda}=\mathrm{d}\Phi/\mathrm{d}\Omega$$
其中，球面度$\Omega = S/R^2$，S是立体角在球面上对应的表面积
辐射强度I的单位是$W/Sr$，其中Sr是球面度（它没有量纲）

### 4.5 辐射亮度
用于**描述面辐射源的辐射特性**。指的是面辐射源**在单位立体角、单位时间内从地表的单位面积（单位投影表面）上辐射出的能量，即辐射源在单位投影面积上、单位立体角内的辐射通量**：
$$ L_{\lambda}=\frac{\mathrm{d}\Phi}{\mathrm{d}\Omega\times\mathrm{d}A\cos{\theta}}$$
其中，A是面辐射源的面积，$\theta$是面的法线与立体角的方向之间的夹角
单位是$W/m^2*Sr$

## 5. 黑体辐射
自然界中温度大于绝对0K的任何物体都具有发射电磁波的能力，这种由于物体中的分子、原子受到激发而发射电磁波的现象称为热辐射。所辐射电磁波的特征仅仅与温度有关

单色辐出度：单位时间、单位表面积内所辐射出的，单位波长间隔中的能量
辐射出射度：单位时间、单位表面积内所辐射出的，所有波长电磁波的能量

黑体：**能吸收各种波长的辐射能，而不发生反射、折射和透射的物体称为绝对黑体，简称黑体**
研究黑体的辐射特性的规律是了解一般物体热辐射性质的基础
**黑体既是完全的吸收体，也是完全的辐射体**
### 5.1 普朗克辐射公式：黑体的热辐射定律
设$M_{\lambda}(\lambda, T)$是**当波长为$\lambda$时温度为T的黑体的辐射通量密度**，称为**光谱辐射通量密度**，单位为$W\times m^{-2}\times \mu m^{-1}$
那么有：
$$  M_{\lambda}(\lambda, T)=\frac{2\pi hc^2}{\lambda^5}\times \frac{1}{e^{ch/\lambda kT}-1}$$
其中，$h=6.626\times 10^{-34}J\times s$，为普朗克常数；$k=1.38\times 10^{-23}J\times K^{-1}$，为玻尔兹曼常数；
c是光速，T是黑体的绝对温度，单位为K

该定律说明了黑体的辐射通量密度与温度的关系，以及当T一定时辐射通量密度关于波长分布和变化的情况

#### 5.1.1 斯特潘-玻尔兹曼定律（积分）
在普朗克辐射公式中，特定温度下**黑体的总辐射通量W**可以通过对$M_{\lambda}(\lambda, T)$关于波长$\lambda$从0到$\infty$进行积分求出：
$$ W=\int_{0}^{\infty}\frac{2\pi hc^2}{\lambda^5}\times \frac{1}{e^{ch/\lambda kT}-1}\mathrm{d}\lambda
$$

进行转换，将该式子**转换到$1m^2$面积内黑体辐射到半球空间中的总辐射通量**，有：
$$ W=\sigma T^4    $$
其中$\sigma = 5.67\times 10^{-8}W\times m^{-2}\times K^{-4}$为玻尔兹曼常数

该定律说明了：**黑体的总辐射通量与其绝对温度的四次方成正比，温度的微小变化会引起总辐射通量的巨大变化**
这就是热红外遥感能够通过探测地物的辐射通量，以推算出物体的绝对温度，识别物体类别的理论基础

#### 5.1.2 维恩位移定律（微分）
对普朗克公式关于波长求微分，并且解出极值，有：
$$ \lambda_{max} T=2.879\times 10^{-3}\mu m*K$$
这就是维恩位移定律，它说明了**黑体的辐射峰值波长与黑体的温度成反比，即黑体温度升高时，其辐射出来的电磁波波长向短波方向移动**

由于**不同温度的黑体的辐射通量密度差异最明显的地方在$\lambda_{max}$附近**，所以我们**可以根据峰值波长来设计识别特定地物的遥感器的响应波段**

### 5.2 黑体辐射的特性
#### 5.2.1 黑体的微波辐射：瑞利-金斯公式
微波是地物**低温状态下**的重要辐射特性，温度越低，微波辐射相对来说更加明显（但是还是比红外辐射弱得多）
对于黑体辐射的微波功率$W_{\lambda}$，有以下公式：
$$ W_{\lambda}=\frac{2kT}{\lambda^2}$$
说明**黑体辐射的微波功率与其温度成正比，与其辐射出来的电磁波波长平方成反比**
不同地物间的微波发射率差异要比红外发射率明显得多，有些地物在微波波段中比在可见光和红外波段中要更容易识别

#### 5.2.2 实际地物的发射特性：发射率
相同温度下，**实际物体的辐射出射度肯定是比绝对黑体要低的**。地物发射能力的大小可以采用**发射率**来表示
发射率是指**地物发射的辐射通量与同温度下黑体的辐射通量之比**，也称比辐射率：
$$ \epsilon = \frac{M^{'}}{M}$$
固定辐射通量为波长$\lambda$下的辐射通量，就是地物发射某一波长的比辐射率

地物的发射率与地物的性质、表面状况有关，并且还是温度和波长的函数，所以**一般来说不同地物的发射率是不一样的**，发射率值介于0和1之间

#### 5.2.3 基尔霍夫辐射定律
该定律的主要内容是：**在任一给定的温度下，不同物体对同一波长的单色辐出度与单色吸收率之比为定值，该值是该温度下黑体对于同波长的单色辐出度**（波长为$\lambda$的单色辐射情况）
换句话说：**任一给定温度下，地物单位面积上的辐射通量密度和吸收率之比对于任何地物都是一定的，并且定值等于该温度下同面积黑体的辐射通量密度**（所有波长的全辐射情况）

$$ M_{\lambda}=\frac{M^{'}_{\lambda}}{\alpha_{\lambda}}$$
其中$\alpha_\lambda$是单色吸收率

所以，根据这个定律，我们结合发射率的定义可以得到：
$$ \begin{align}
\alpha_\lambda &= \frac{M^{'}_\lambda}{M_\lambda}\\
&=\epsilon_\lambda （对单一波长的发射率）
\end{align}$$
也就是说，**一个物体的波谱发射率等于其波谱吸收率，好的吸收体也是一个好的发射体**

### 5.3 灰体和选择性辐射体
1. 灰体（Gray Body）  
灰体是指一种理想化的物体，它**在所有波长范围内的==发射率==都保持恒定，并且小于1**。灰体与黑体的不同之处在于，黑体的发射率在所有波长上均为1，而灰体的发射率是一个常数 $\epsilon (0\leq \epsilon \leq 1)$

2. 选择性辐射体（Selective Radiator）  
选择性辐射体是指一种物体，它的辐射能力不仅依赖于温度，还**显著依赖于波长**。换句话说，**选择性辐射体的发射率是波长的函数**，通常在某些波长区域内发射率较高，而在其他波长区域内则较低。

## 6. 大气对电磁波的影响
### 6.1 大气圈层
从下到上依次分为：
- 对流层：航空遥感的主要活动区域，侧重于研究电磁波在该层内的传播特性
- 平流层：电磁波较为微弱
- 中气层：温度随高度增加而递减
- 热层：是增温层和电离层，卫星在这里运行
- 大气外层：1000公里以外的星际空间

大气的主要成分：
- 分子：氮气、氧气、臭氧、二氧化碳、水分子等
- 颗粒：烟雾、尘埃、气溶胶

### 6.2 大气对太阳辐射的作用
#### 1. 吸收作用
太阳辐射到达地面时，对于各波段均有吸收作用。吸收作用越强的波段，辐射强度衰减越大，甚至完全无法通过大气，形成了电磁波的某些吸收带

#### 2. 散射作用
散射作用本质上是**辐射在传播过程中遇到小微粒而使传播方向改变，向各个方向散开**的现象，实质是**电磁波的衍射**
散射作用使得电磁波增加了其他方向的辐射强度，而在原传播方向上的辐射强度减弱
下面是主要的散射类型：
##### 2.1 瑞利散射（影响波长较小的波段：可见光、近红外）
主要**由大气中的分子成分引起**，粒子的直径比波长小很多
这种情况下，有**散射强度与波长的四次方成反比**，波长越长，散射越弱

因此，**瑞利散射的强度随着波长增加而急剧下降：紫外线的瑞利散射强度是红外线的30倍**，所以紫光最先被散射，蓝光到达地面附近最多，因此天空是蓝色的

##### 2.2 米氏散射（主要影响红外波段）
**由大气中如烟雾、气溶胶等微粒引起的散射，粒子的直径与辐射波长相当**
这种情况下，**散射强度受气候影响很大，并且有散射强度与波长的平方成反比**
而且散射光的方向性较为明显：向前的散射强度比向后的更强

**云雾对红外线的散射主要是米氏散射**，这是因为粒子大小与红外线的波长接近，所以米氏散射主要影响红外波段

##### 2.3 无选择性散射
当**粒子比波长大得多的时候**，散射的特点就与波长没有关系了：**对于任何波长的散射强度都相同**

所以，波长很长的微波探测在穿越大气方面有着很强的能力，具有优越性

#### 3. 折射作用
当电磁波穿过大气层时，会产生传播方向的改变，这就是折射现象

**大气密度越大，折射率越大；离地面高度越大，空气越稀薄，折射率越小**

#### 4. 反射作用
主要发生在云层顶部，取决于云量和云雾。不同波段的大气影响也不同。
云层对电磁波的反射作用也削弱了电磁波的强度

#### 5. 透射
存在电磁波通过大气层时**较少被反射、吸收或散射的，透过率较高的波段区间**，这样的波段区间就是对地观测时可利用的部分。
下面介绍的大气窗口就阐述了这个概念

### 6.3 大气窗口
电磁波通过大气层时，较少被反射、吸收和散射的那些透过率高的波段，称为大气窗口
也就是太阳光透过大气层时透过率较高的光谱段

大气窗口是**对地遥感**时所利用的部分，对于对云层遥感，所利用的波段范围就会不同了

#### 常用的大气窗口
- $0.3\sim 1.3\mu m$，紫外、可见光、近红外波段，是摄影成像的最佳波段和许多卫星传感器扫描成像的最佳波段
- $1.5\sim1.8\mu m, 2.0\sim 3.5\mu m$，近红外、短波红外和中红外波段，在白天日照条件好的情况下常用
- $3.5\sim5.5\mu m$，中红外波段，物体的热辐射较强，除了反射太阳辐射之外，地物还有自己发射的能量
- $8\sim 14\mu m$，远红外波段，主要来自物体的热辐射，适用于夜间成像和探测温度
- $0.8\sim2.5cm$，微波波段，全天候工作，穿透云雾能力强，多为主动遥感

## 7. 反射波谱曲线
地物波谱：**地物的电磁波相应特性随电磁波波长改变而变化的规律**
不同类型的地物的地物波谱特性不同，地物波谱特性是遥感识别地物的基础

### 7.1 物体反射电磁波的三种形式
- 镜面反射：电磁波有确定的反射方向，反射角与入射角相等，两者与法线共面。镜面反射的能量很强，只在被地物吸收时消耗一部分，此时会导致像片上形成白色亮点，影响地物的呈现，摄影时应该避免
- 漫反射：电磁波入射到粗糙面后向各个方向反射能量
  朗伯面：对于漫反射，当入射照度一定时，从任何角度观察反射面，其反射亮度是一个常数

- 方向反射：反射面不完全是粗糙的朗伯表面，也不完全是镜面，只是在某些方向上反射最强烈，在不同方向观察地物，亮度不一样

朗伯反射光和方向反射光都是部分偏振光

### 7.2 衡量地物反射特性的量
- 反射率：（反射辐射通量/入射总辐射通量）\* 100%  （辐射通量和能量在这里的作用差不多，因为是比值）
- 吸收率：（吸收能量/入射总能量）\* 100%

地物反射光谱特性曲线：**直角坐标系中，表示地物的反射率随波长变化而变化的规律的曲线**

### 7.3 典型地物的反射波谱曲线及其特征
#### 1. 植被
- $0.4\sim 0.76\mu m$：位于绿色波段$0.55\mu m$的地方有一个小的反射峰，两边蓝红波段为吸收带，呈现凹的吸收谷形状，这是叶片内的色素吸收作用引起的（叶绿素）
- $0.76\sim 1.3\mu m$：反射率迅速增大，在$0.7\mu m$处升高，$1.1\mu m$处达到峰值，这是因为叶片的细胞结构导致产生多重反射而引起的
- $1.3\sim2.5\mu m$：短波红外波段，受植物含水量的影响，吸收率增加，反射率下降。含水量增加，反射率下降，反之上升。

#### 2. 土壤
没有明显的波峰波谷，土质越细，反射率越高；有机质含量、含水量越高，反射率越低
随波长增大，反射率逐渐升高

#### 3. 水体
反射率总体较低。在可见光波段有一定反射，而在近红外波段几乎成为全吸收体

#### 4. 岩石
曲线形态各异，没有统一的规律，影响因素有：矿物成分、含量、风化程度、含水状况、颗粒大小、表面光滑程度、色泽等

### 7.4 地物反射波谱特性的测量
可见光和近红外波段是研究地表的主要波段，对它们进行光谱测试的作用：
- 传感器波段的选择、验证和评价
- 建立地面、航空和航天遥感数据的定量关系
- 地物光谱数据与地物特征的相关分析

#### 几何因素对光谱模式的影响
影响因素：太阳方位角与天顶角、观测方位角与天顶角、地物局地坡度、地物表面粗糙度

# C2. 遥感传感器及其原理：可见光与热红外

## 1. 遥感数字图像

**遥感图像是对二维空间上的连续型能量强度进行离散化采样后并量化后的表示**

采样：按照一定的**空间网格**对**区域**进行**离散化**（坐标表示）
量化：对每个离散网格单元（也称采样点/像元）的**辐射能量值进行数字化**（亮度表示）

具体来说，对观测区域进行离散化，用网格进行划分，每一小格取这一格范围内的平均辐射能量值作为该方格的值。因此，离散化的精度决定了图像的**空间分辨能力**

遥感数字图像可以理解为多个波段的多维数组，每个像元的明暗程度记录了成像瞬间对应的物体的反射光强度（灰度），实质是**探测范围内电磁辐射能量的分布**

### 1.1 遥感图像的量化
将采样过程中获得的像元平均辐射值按照一定的编码规则划分为若干等级，常用的`8bits`、`9bits`或`11bits`指的是按照$0\sim 2^{n}-1$进行划分（计算机位存储）
量化的方法包括**均匀量化和非均匀量化**，表示将从最暗到最亮的灰度范围进行的划分是否均匀。遥感中通常采用均匀量化的方式划分灰度为有限个层次

### 1.2 采样点数和量化级数对图像质量的影响

- 对一副图像，量化级数一定时，采样点数越多，图像质量越好，当采样点数越少，图上的**块状效应**就越明显
  **采样点数对应图像空间分辨能力，与传感器的空间分辨率相关**
  
- 当采样点数一定时，量化级数越多，图像质量越好，量化级数最小的极端情况下会出现**假轮廓**效应
  **量化级数对应图像辐射分辨能力，与传感器的辐射分辨率相关**

## 2. 遥感传感器及其性能
### 2.1 遥感传感器分类
遥感传感器是一种能感受到被测量的信息，并将信息按一定规律变换成为电信号或其他所需形式的信息进行输出的检测装置
传感器原理：应用物理效应，例如压电效应、磁致伸缩效应等，将被测信号量的微小变化转换为电信号

$$ 遥感传感器分类\begin{cases}
被动方式\begin{cases}
非扫描\begin{cases}
非图像方式\begin{cases}
微波辐射计\\
地磁测量仪\\
重力测量仪\\
傅里叶光谱仪\\
其他
\end{cases}\\
图像方式（照相机）\begin{cases}
黑白\\
天然彩色\\
红外\\
彩色红外\\
其他
\end{cases}

\end{cases}\\
扫描（图像方式）\begin{cases}
像面扫描\begin{cases}
电视摄像机\\
固体扫描仪OCD
\end{cases}\\
物面扫描\begin{cases}
光机扫描仪\\
固体扫描仪
\end{cases}
\end{cases}
\end{cases}\\
主动方式\begin{cases}
非扫描（非图像方式）\begin{cases}
微波散射计\\
微波高度计\\
激光光谱仪、高度计、水深计、测距仪
\end{cases}\\
扫描（图像方式）\begin{cases}
物面扫描\begin{cases}
微波辐射计\\
真实孔径雷达\\
合成孔径雷达
\end{cases}\\
像面扫描：被动型相控阵雷达
\end{cases}
\end{cases}
\end{cases}
$$


### 2.2 遥感传感器性能度量
#### 1. 空间分辨率
传感器在某一时刻所能感测的外来光（或其他电磁波）所来自的**空间角度区域**

- 瞬时视场角：传感器的**张角及瞬时视域**，也称**角分辨率IFOV**

$$
\begin{align}
空间分辨率 &= 平台高度 * 角分辨率（以弧度为单位）\\
D &= H * IFOV
\end{align}$$

遥感图像上**能够详细区分的最小单元的尺寸**是用来表征图像分辨地面目标细节能力的指标，它与IFOV有关，通常用**像元大小、像解率或视场角**来表示
IFOV决定了给定高度上瞬间观测的地表面积，它就是传感器所能分辨的最小单元，由

像元：**将地面信息单元离散化而形成的格网单元**。是组成图像的基本单元，单位为米，**像元越小，空间分辨率越高**

#### 2. 辐射分辨率
遥感传感器记录从地表反射、发射或后向散射的辐射通量时，遥感检测器响应信号强度差异的灵敏度。也就是**恰能分辨的最小辐射差异（转换为电信号时的信号变化水平）**
在遥感图像上表现为**每一像元的辐射量化级别**，例如之前所说的`k-bits`就是$2^k$级

辐射量化强度过低，会出现伪轮廓现象

#### 3. 波谱分辨率（光谱分辨率）
指传感器在接收目标辐射时能感应得到的电磁波谱中**特定**的**最小波长间隔的数量和大小**。间隔越小，波谱分辨率越高
指传感器所使用的波段数、波长以及波段宽度，即：**选择的通道数、每个通道的波长和带宽三个要素决定了光谱分辨率**，波段数量越多、带宽越窄，光谱分辨率越高



传感器的波段必须考虑目标对象的光谱特征值，才能取得好效果

#### 4. 时间分辨率
对**同一目标进行重复探测**时，相邻两次探测的**时间间隔**（重访周期）
可以以小时、天、年为单位


#### 5. 全色影像和多光谱影像的区别

- **全色影像（Panchromatic Image）**：
    - 全色影像只记录一个波段的数据，通常是宽波段（可见光范围的总和，或从蓝到近红外的宽光谱）。
    - 它的光谱分辨率较低（即没有细分波段）。
- **多光谱影像（Multispectral Image）**：
    - 多光谱影像记录多个窄波段的数据，例如红光、绿光、蓝光、近红外等。
    - 光谱分辨率较高，因为光谱范围被分成了多个窄波段。

因此，全色影像接收的光谱范围比多光谱影像宽，能量更多。由于接收能量决定了信噪比，多光谱影像传感器需要通过更大的像元面积（即较低的空间分辨率）来积累更多能量以获得足够的信噪比，这就导致**全色影像的空间分辨率高于多光谱影像**

#### 6. 高光谱影像的空间分辨率一般较低

 **高光谱影像的特点**
- 高光谱影像记录的光谱波段非常多（几十到几百个），光谱分辨率非常高。
- 每个波段都对应一个非常窄的光谱范围。

所以，波段范围较窄，接收能量较少，由于接收能量决定了信噪比，多光谱影像传感器需要通过更大的像元面积（即较低的空间分辨率）来积累更多能量以获得足够的信噪比

#### 7. 空间、辐射、光谱分辨率之间的制约关系与权衡

#### **1. 空间分辨率与光谱分辨率**

- **制约**：
    - 提高**空间分辨率（更小的像元）会减少单像元接收的能量**。
    - 如果光谱分辨率较高（波段很窄），单个波段接收到的能量也会减少。
    - 两者的共同降低会导致信噪比不足。
- **解决方法**：
    - 在实际设计中，一般需要根据应用需求在两者之间进行平衡：
        - 如果关注地物的形状和细节（如城市监测、军事侦察），优先提高**空间分辨率**。
        - 如果关注地物的物质组成和光谱特性（如植被分析、矿物探测），优先提高**光谱分辨率**。

#### **2. 空间分辨率与辐射分辨率**

- **制约**：
    - 较高的空间分辨率（小像元）会导致单像元接收到的能量减少，降低信噪比。
    - 如果同时要求高辐射分辨率（更多量化级别），需要更高的信噪比来分辨细微的辐射差异，可能导致数据不准确。
- **解决方法**：
    - 如果单像元能量不足，可通过增加探测时间（降低时间分辨率）或更高灵敏度的传感器来提高信噪比。

#### **3. 光谱分辨率与辐射分辨率**

- **制约**：
    - 较高的光谱分辨率（更多窄波段）会降低每个波段的接收能量，从而可能影响信噪比。
    - 如果辐射分辨率较高，对信噪比的要求会进一步增加。
- **解决方法**：
    - 在光谱分辨率很高的情况下，可以适当降低辐射分辨率，确保数据的可靠性。
    - 设计传感器时，通过调节滤波器和光学系统优化能量接收效率。

权衡：根据应用场景决定应该牺牲哪些分辨率以提高所需的分辨率，**降低其中一个维度的分辨率**，以换取其他两个维度的更高分辨率。还可以在卫星中同时搭载多种分辨率性能不同的传感器以实现多模式共同合作

### 2.3 遥感传感器数据采集
遥感数据采集的实质是**汇集能量并量化记录**：一幅图像实际上记录的是物体辐射能量的空间分布，是空间坐标、时间和波长的函数

传感器采集能量的多少的影响因素：观察面积的大小、汇聚能量的光谱区间、观察驻留时间长短、其他因素
为了尽可能的收集能量，可以采取：
- 扩展观察单元的面积：这会导致降低空间分辨率
- 扩展汇聚能量的光谱区间：会导致降低光谱分辨率
- 延长观察驻留的时间：这就是后面的应用了，点扫式、线扫式、面阵成像


## 3. 典型的成像传感器
### 3.1 摄影成像
利用光学镜头和放置在焦平面上的感光胶片等组成的成像系统记录地物影像的技术

按照观测波段的不同，分为紫外、可见光、红外和多光谱摄影等
限制：受感光剂的限制，感光范围在$0.26\sim1.10\mu m$

传感器主要包括框幅式摄影机、缝隙摄影机、全景摄影机和多光谱摄影机
$$ \underbrace{<100mm}_{短焦距}\underbrace{\sim200mm}_{中焦距}\underbrace{<}_{长焦距}
$$
### 3.2 扫描式传感器
逐点逐行以时序方式获取二维图像
#### 1. 摆扫
在物镜焦平面上平行于飞行方向设置一狭缝，随物镜作垂直航线方向扫描。物镜向两边摆动，由于摆动的幅度很大，可将航线两边地平线内的影像摄入底片

瞬时视场角相同，但是不同的入射角也会导致地面覆盖面积不同。
摆动的总视场角（TFOV：摆动扫描模式下，传感器在扫描期间所能覆盖的最大视场角范围）不宜过大，大约$70\degree\sim 120\degree$
总视场角与瞬时视场角关系：$TFOV = N\times IFOV$，N是传感器在扫描方向上的采样点数量（即传感器的探测阵列长度或扫描步骤数量）

#### 2. 推扫
用固定的探测元件，组成线阵列或面阵列，通过遥感平台的运动对目标地物进行扫描的方式，像刷子扫地一样扫出一条带状轨迹，获取沿飞行方向的地面二维图像
目前常用的探测元件是**电荷耦合器件CCD**


## 4. 高光谱遥感：成像光谱仪
成像光谱技术：在一定波长范围内，传感器的探测波段分割越多（光谱采样点越多），所获取数据的连续性越强，使得传感器在获取目标地物图像的同时，也能获取反映地物特点的连续光滑的光谱曲线（“图-谱合一”）

图像由多达数百个非常窄的连续光谱波段组成，覆盖了全部光谱带，图像的每一像元均得到连续的反射率曲线。多采用扫描式或推帚式

### 4.1 点扫式成像光谱仪
利用**点探测器**收集光谱信息，经色散元件后分成不同波段，分别传送在线阵列探测器的不同元件上，通过点扫描镜在垂直于轨道方向的面内**摆动**以及沿轨道方向的运动完成空间扫描，而**利用线探测器完成光谱扫描**

特点：
- 总视场角大，摆动扫描
- 像元配准好：不同波段在任何时候都凝视同一像元
- 光谱覆盖范围广
- 对像元摄像时间短

### 4.2 线阵扫帚式成像光谱仪
**利用线阵列探测器沿轨道方向运动进行空间扫描**，利用色散元件和面阵探测器完成光谱扫描

特点：
- 总视场角受限制
- 像元摄像时间长
- 可见光波段分辨率高，短波红外灵敏度低，热红外暂时不能感应

## 5. 热红外遥感
热红外遥感就是利用传感器收集、记录地物的热红外信息，并利用其来识别地物和反演地表参数（温度、湿度等）的技术
常指**中红外与远红外遥感**

地物比辐射率：物体在温度T、波长$\lambda$处的辐射强度与同温度、同波长下的黑体**辐射强度**的比值：
$$ \epsilon = \frac{B_{S\lambda}(T)}{B_{B\lambda}(T)}$$
辐射温度：所测量物体的辐射能量所对应的温度。对于黑体，其辐射温度等于真实温度；而对于真实物体，辐射温度$T_{rad}$和地表温度$T_{kin}$的关系近似为：
$$ T_{rad} = \epsilon^{1/4}T_{kin}$$
地物的辐射温度总小于它的热力学温度，对于任何地物，热遥感器记录的辐射温度小于其真实温度


热红外传感器设计原则：
- 预期探测目标在所选择热红外波段具备最强的信号特征 
- 所探测的遥感信息能最大限度地透过大气到达传感器

热红外阴影的实质：**地表温度较低的区域在热红外影像中表现为暗区**

# C3.  遥感平台及运行特点

遥感平台：遥感中搭载传感器的工具

| 类型   | 概念                    | 优点                    |
| ---- | --------------------- | --------------------- |
| 航天遥感 | 利用卫星、航天飞机、宇宙飞船等携带遥感仪器 | 覆盖范围大                 |
| 航空遥感 | 利用飞机携带遥感仪器            | 机动性强，可选择适合的传感器、高度、区域等 |
| 近地遥感 | 距离地面高度几十米以内的遥感        | 用于需要中、高分辨率的遥感活动       |

## 3.1 卫星轨道及运行特点

卫星运行的轨道面：卫星在太空中运行的包含地球在内的平面
轨道参数：描述卫星轨道特征的数值
轨道面参数有：长半轴、偏心率、倾角、近地点角距、过地点时刻
轨道描述参数：卫星高度、运行周期、扫描带宽度、重复周期

#### 遥感卫星的轨道类型
1. 地球同步轨道：卫星运行周期等于地球自转周期。从地面上各方向看过去，卫星在赤道上的一点保持相对静止

2. 太阳同步轨道：卫星的轨道面绕地球的自转轴旋转，旋转方向与地球的公转方向相同，且**旋转角速度等于地球公转的平均角速度**，卫星的轨道面始终与当时的“地心-日心连线”保持恒定的角度

采用太阳同步轨道的目的：确保卫星大约在同一地方时经过成像区域

#### 不同遥感任务对于卫星轨道的要求
- 空间科学探测：一般采用**大偏心率轨道**
- 对地全球观测：一般采用**太阳同步轨道**
- 地面目标侦察：要求卫星在目标上空时轨道高度较低，便于获取高分辨率图像
- 全球通信或导航：需要多颗卫星组成星座

#### 遥感平台的瞬时参数描述
X、Y、Z和姿态角，用于描述遥感平台运行时的侧翻、俯仰与偏航现象

# C4. 微波遥感基础

微波遥感：指在微波电磁波段内，通过接收地面目标物辐射的微波能量（被动形式），或接收传感器本身发射出的电磁波束的回波信号（主动形式），判别目标物的性质、特征和状态的遥感技术

## 4.1 微波遥感特点
- 全天时、全天候的工作能力
- 对地物具有一定的穿透能力
- 能获得可见光和热红外遥感所不能提供的特定信息
- 精确的测量能力

## 4.2 微波遥感电磁波特征
平面波：电磁波的电场矢量和磁场矢量均在垂直于传播方向的平面上，且幅度为常数
特征：
- 叠加：当两列波在同一空间传播时，空间上各点的振动为各列波单独振动和合成。任何复杂的电磁波都可以分解为比较简单的电磁波
- 相干：由两个或以上的频率、振动方向相同，相位差恒定的电磁波在空间进行叠加时，合成波振幅为各个波的振幅的矢量和
  干涉现象：交叠区某些地方振动加强，某些地方振动减弱甚至完全抵消
  **雷达天线产生的微波就近似平面波**，正是因为微波的相干性，微波雷达图像的像片上会出现**颗粒状或斑点状的特征**，这是非相干的可见光相片上所没有的

- 极化：电场振动方向的变化趋势（电磁波的电场矢量在传播过程中发生的变化趋势）
   - 线极化：电场矢量方向不随时间变化的情况（电场矢量始终在一个平面内振动。振动方向是固定的）
      - 水平极化：电磁波的电场矢量与入射面垂直（入射面：入射波与目标表面入射波到达处的法线所组成的平面）
      - 垂直极化：电磁波的电场矢量与入射面平行

线极化电波在通过电磁场时，在磁场的影响下产生极化面相对入射波的旋转，旋转大小与电波频率、电离层电子密度、传播路径长度有关

微波就是一种线极化电波，它穿过大气层时会产生法拉第旋转，**旋转的程度和频率的平方成反比**，低频长波的旋转程度大
正因如此，单一的线极化测量具有巨大的局限性

- 多普勒效应：电磁波因辐射源或观察者相对于传播介质的运动，使得观察者接收到的电磁波频率产生变化的现象，其程度与相对速度V成正比，振动频率成反比。
  **多普勒效应是合成孔径雷达的工作原理**

- 衍射：波在传播过程中经过障碍物边缘或孔隙时发生的传播方向弯曲的现象
  一切波都会发生衍射现象，孔隙越小，波长越大，衍射现象越显著。它在遥感中的应用是：天线：发射时类似于线性波阵面，接收时类似于电磁场中的小孔；当地物目标的大小与微波波长相当时，会引起衍射

## 4.3 微波遥感传感器与原理
$$ 
微波遥感传感器分类\begin{cases}
主动方式\begin{cases}
1.雷达（侧视雷达）：成像\\
2.微波高度计：不成像\\
3.微波散射计：不成像
\end{cases}\\
被动方式：微波辐射计：成像
\end{cases}
$$
### 1. 微波辐射计（被动）
微波辐射计主要用于探测地面各点的**亮度温度**并生成亮度温度图像，亮度温度根据地物的微波发射强度进行换算
亮度温度：辐射出与被测物体相等的辐射能量的黑体的温度

### 2. 微波散射计（主动）
由微波发射器、天线、微波接收机、检波器和数据积分器组成，**测量地物的散射特性随雷达波束的入射角、极化和波长变化的规律**

### 3. 雷达
#### 1. 侧视雷达（真实孔径雷达）SLR
侧视雷达在随飞行器前进的过程中，向垂直于航线的方向（也称**距离向**）发射具有特定波长的微波脉冲，形成一个扇状波束，这个波束在航行的方向（也称**方位向或航迹向**）很窄，距离向很宽：
![[Pasted image 20241201195610.png]]
扇状波束照在目标的不同部位时，会出现**先后时间差异**，因此从目标反射回的回波也出现时间差，近距离地物先被天线所接收，按照地面回波信号到达天线的时间顺序和回波信号的强度实现距离方向上的扫描成像；而随着遥感平台的前进连续发送这样的扇状波束，实现了航向方向的扫描成像

侧视雷达在**雷达天线到目标地物的连线方向（斜距方向）** 上进行记录：
![[Pasted image 20241201200907.png]]
显然，**目标实际地面距离（地距）大于记录的距离（斜距）**，斜距方向的图像会产生变形，而地距图像不会，因此通常需要在硬件中增加延时电路或在处理器中加入几何校正，将斜距图像转换为地距图像

##### 距离分辨率
指的是**在雷达脉冲发射的方向上（距离向，也就是地面中垂直于遥感平台的那个方向），能够分辨的两个目标之间的最小距离** 
也就是说距离方向上，目标地物之间的距离必须大于距离分辨率，才能被辨认出

距离方向上地物的区分，要求目标的回波信号到达天线的时间之间具有时间差，因此，**距离分辨率取决于脉冲持续时间（脉冲宽度，也称脉冲长度）**
注意，脉冲宽度和雷达波长是两个不同的概念，脉冲宽度可以理解为上面图像中扇状波的宽度，可能到达几米。若脉冲宽度过高，或者两个目标过近，都会导致反射的脉冲出现时间上的重叠，使得目标无法分辨

距离向又可以被细分为斜距方向和地距方向
设$\tau$为脉冲持续时间，c为光速，则$脉冲宽度=\tau\times c$

**斜距分辨率**：因为雷达在斜距方向获取回波，理论上，斜距分辨率就是脉冲宽度的一半：
$$ R_{sr}=\frac{\tau\times c}{2}$$
再设雷达的俯角（斜距方向与水平方向之间的夹角）为$\gamma$，将斜距转换为地距，则有
**地距分辨率**：
$$ R_{gr}=\frac{\tau\times c}{2\cos\gamma}$$

总结以下距离分辨率的性质：
- **脉冲宽度越小，距离分辨率越高**，这会需要减少脉冲持续时间，但是脉冲持续时间越短，信噪比越高，所以需要进行权衡
- 距离分辨率还与雷达的俯角有关：**俯角越小，分辨率越高；越大，分辨率越低**，因此，近射程点（靠近雷达的地物）分辨率低，远射程点分辨率高，这也是为什么需要侧着发出微波电波

##### 方位分辨率
指的是**在雷达飞行方向上能分辨的两个地物之间的最小距离**
我们知道，扇状波束在地面上的投影是有面积的，这个面积沿着方位向的距离的截线宽度很短
![[Pasted image 20241201205434.png]]
（截线指的是这个扇形被竖直切割得到的一条条线段）
这个宽度称为波束宽度$R_a$，在飞行方向上，如果想要**区分两个平行于截线放置的地物**，它们必须要在两个不同的波束内：若在同一波束，它们的回波是完全重合的，图像上共点，因此无法区分

所以，就像上图中1和2 ， 与 3和4 的区别，1和2不能被同一个波束同时囊括，因此可以被区分；3和4则不行

综上所述，雷达的**方位分辨率就是波束宽度**
**真实孔径雷达的波束宽度与波长$\lambda$成正比，与天线孔径D成反比**，设天线到地物的距离（斜距）为$R_s$，显然$R_s=h/\cos\gamma$，h是雷达到地面的高度，$\gamma$是倾角
则有**真实孔径雷达的方位分辨率：**
$$ R_a = \beta\times R_s=\frac{\lambda}{D}\times R_s=\frac{\lambda\times h}{D\cos\gamma}$$

#### 2. 合成孔径雷达SAR
理论上，对于真实孔径雷达，增加其孔径D可以显著提高方位向分辨率，但是直接增加孔径非常困难，孔径的大小直接决定了天线的几何尺寸。因此，SAR采取了另外的方法来变相增加孔径大小

合成孔径雷达和真实孔径雷达的区别在于：SAR**用一个小天线作为一个辐射单元，将这个单元沿着一条直线不停移动，在不同位置上接收同一地物的回波信号，并进行相关解调压缩处理**
通过计算机合成处理后，能得到相当于从大孔径天线中获取的信号：
![[Pasted image 20241201211715.png]]
也就是小孔径不断移动形成大孔径，称为合成天线技术

##### 距离分辨率
SAR的距离分辨率和真实孔径雷达一模一样，因为它和孔径大小无关

##### 方位分辨率
SAR使用合成天线技术获得了更大的等效孔径。设SAR的波束宽度为$\beta_s$，那么
$$\begin{align}
\beta_s &= \frac{\lambda}{D_s}
\\
&= \frac{\lambda}{2L_s}\\
&= \frac{\lambda}{2\beta\times R_s}\\

\end{align}
$$
因为天线一来一回地运动，所以$L_s$要乘上2；而为了保证每次接收同一地物的回波，又控制$L_s$的长度为$\beta\times R_s$，这里$\beta$即天线不运动时的波束宽度

代入方位分辨率计算公式有：
$$ \begin{align}
R_a&=\beta_s\times R_s\\
&= \frac{\lambda}{2\beta\times R_s}\times R_s\\
&= \frac{\lambda}{2\beta}\\
&=\frac{\lambda}{2\lambda/D}\\
&=\frac{D}{2}
\end{align}$$
其中D是天线的真实孔径的宽度

因此，**合成孔径雷达的方位分辨率与距离无关，只与天线的孔径大小有关：大小越小，方位分辨率越大**

### 4. 雷达图像的几何特征
#### 4.1 斜距显示的近距离压缩
根据两个地物距离雷达的距离不同，即使它们的地距相等，斜距也会不同。固定地距的两点离雷达越近，其斜距越短
因此，**近射程点（靠近雷达的地物）分辨率低，远射程点分辨率高**，就是斜距显示的近距离压缩了，也称为**比例失真**，因为（未校正的）雷达图像在距离方向上的比例尺随着地物离天线距离越近而发生变化

#### 4.2 侧视雷达阴影
侧视雷达**在==距离向==会产生雷达阴影**，原因是**起伏地形的后坡雷达波束不能到达，没有回波信号，因此在图像相应位置出现暗区**

一共会有以下三种情况，设雷达俯角为$\beta$，地形后坡坡角为$\alpha_b$：
- 坡角小于雷达俯角：不会产生阴影
- 坡角等于雷达俯角：按照后坡的粗糙度不同决定是否产生阴影
- 坡角大于雷达俯角：会产生阴影
![[Pasted image 20241201215001.png]]如果后坡足够粗糙，可以视为后坡上有很多凸起，此时雷达波束擦掠后依然会被反射部分回波，因此不会产生阴影；若很光滑，那就不会有回波，出现阴影

#### 4.3 透视收缩
在山区或丘陵的雷达图像中，**面向雷达一侧的山坡长度与其真实长度相比明显变小了**，这是透视收缩效应的体现
透视收缩指的是**面向雷达波束的斜面，投影至斜距方向时，距离天线越近的斜面，会产生的距离压缩效应增强**的现象：
![[Pasted image 20241201215855.png]]
对于斜面AB而言，$A^{'}B^{'}$显然会小于AB，这是投影到斜距的收缩效应导致的
而对于坡度与AB相同的斜面CD，因为该斜面距离天线更近，因此投影到斜距方向的$C^{'}D^{'}$更小，几乎变成了一个点

所以在起伏地形中，即使按照比例计算，得到的山坡长度也比实际长度要短

侧视雷达的透视收缩规律：
- **前坡总是比后坡的距离压缩效应更明显**。较大的回波能量集中体现在较小的图像区域中，所以在强度图像上，**坡面亮度更高，且前坡比后坡更加明亮**

- 当地入射角为0时，即当**斜坡垂直于入射到最高点的斜距方向**时，出现最大透视收缩：山顶、山腰、山底的回波集中到同一点上（如上图中的线段CD，设天线为O，那么有OD垂直于CD，投影到斜距是沿着扇形轨迹进行的）

- 图像的透视收缩比率与局部入射角有关（也就是入射到最高点D的那条线的角度）

#### 4.4 叠掩
对于地表高大的山体，雷达波束首先到达其顶点B，后到达其底部A，导致**山体顶部的回波信号先于山体底部到达，所以雷达图像上山体顶部和底部的位置被颠倒，形成倒像**，这就是叠掩现象

不是所有山体都会产生叠掩，**只有当雷达波束俯角与坡度角之和大于90度时才会出现叠掩**
此时的一个修正方式是**将数字高程影像与雷达影像相比对，修改会出现叠掩区域的山顶和山底位置**

### 5. 侧视雷达的信息特点
#### 5.1 图像参数
##### 工作参数
工作参数是成像的基本条件，包括**波长、极化方式、俯角、照射带宽、距离显示形式**，除此以外还有雷达系统运行平台的**高度、姿态、成像时间和经纬度等飞行参数**

##### 质量参数
质量参数直接影响到图像的信息特点和目标地物的可解译程度，主要包括**分辨率和几何精度**，这里介绍分辨率：
- 空间分辨率：雷达图像上**可区分的两个目标之间的最小距离**，包括距离分辨率和方位分辨率。描述空间分辨率时通常采用**距离分辨率与方位分辨率的乘积，也称面分辨率**，实践证明，只要面分辨率一致，图像解译的效果就不会有影响
- 灰度分辨率：**图像上可以分辨的雷达回波信号强度的最小差异**，它决定了图像的对比度和所能表现出来的地表信息量的大小

（注意：辐射分辨率是传感器的参数，衡量它所能捕获的波长微小变化的差异的能力）

#### 5.2 影响图像色调的因素
雷达图像多为单波段图像，因此灰度和灰度空间变化是雷达图像信息的主要依据
- 灰度：是地物目标后向散射回波强度的表现形式，通常以雷达后向散射截面面积或**后向散射系数**表达
- 一般认为，后向散射系数是**雷达系统的波长$\lambda$，入射角$\sigma$，极化方式P和地物目标的参数：方位角$\phi$，负介电常数$\epsilon$，表面粗糙度和次表面粗糙度，以及不均匀介质中的体散射系数**的函数。
- 因此，下面介绍的因素就是上述后向散射系数的影响参数
##### 表面粗糙度
指的是小尺度的粗糙度，即尺度比分辨单元尺寸小的多的地物表面粗糙度，由细小的物质所决定
- 完全光滑的表面产生镜面反射，几乎所有反射的能量都集中在以反射线为中心的很小的立体角范围内（暗色调）
- 中等粗糙表面在各个方向上均有反射能量，产生漫反射或散射，回波较弱（灰色调）
- 非常粗糙表面近似于各向同性散射，回波较强（亮色调）

粗糙度不仅取决于高度h，还与波长和俯角（入射角）有关，同一地表，对于长波显得光滑，对于短波则可能是粗糙的，因此具有相对性

##### 波长
波长通过以下两个方面影响回波信号：
- 波长不同，有效粗糙度不同（粗糙度具有相对性），影响回波能量
- 波长不同，复介电常数响应不同，影响目标反射能力和电磁波穿透力

##### 入射角
- 入射角的变化会改变可分辨单元的面积（斜距方向投影）
- 入射角变化会影响平均散射系数：$\sigma^0(\theta)=\sigma^0(0)\cos\theta$

##### 地物的复介电常数
地物目标的性质对于雷达回波的影响是很大的：一般来说，复介电常数越高，反射雷达波束的作用越小，**穿透作用越小，雷达回波强度越大，图像色调越浅**。
复介电常数的实部是介电常数，虚部表示损耗因子，损耗因子值就是电磁波传输过程中的损耗或衰减，与物质传导率有关

**复介电常数相对于地物单位体积内的液态水含量线性变化：含水量越大，复介电常数越大，因此水分含量也常常代替复介电常数**
例如，土壤的含水量越多，反射越强
金属物体导电率很强，因此复介电常数也很大；在矿物识别中，含矿量高的岩石复介电常数也更大

##### 极化方式
电磁波是由相互垂直的电场矢量和磁场强度矢量表征的，都与其传播方向垂直。如前所述，当电磁波的电场矢量在一个固定平面内沿着固定方向振动，称为偏振，在微波遥感中称为极化
- 水平极化H：雷达波的电场矢量垂直于波束入射面
- 垂直极化V：雷达波的电场矢量平行于波束入射面

**与地表地物发生作用后，极化状态可能发生改变**，不同地物反映出不同的极化特性，因此发射电磁波和回波的极化性质是与地物相互作用后的结果，可以作为遥感信息获取

雷达可以采取相同或不同的方式发射和接收电磁波，获得同向极化图像或异向极化图像：HH、VV、HV或VH
- HH对研究土壤湿度、船舶检测和区分边界有利
- VV对研究作物和海浪有利
- HV和VH对区分植被与非植被边界、水的边界、土壤湿度和表面粗糙度有利

##### 体散射
指的是当雷达波束穿透地物时，由于地物内部物质的不均匀性和连续的空间位置分布，引起体内散射的**各向同性**

#### 5.3 雷达图像上的特殊现象
##### 地物目标的类型及其产生的光斑效应
- 面目标（分布型目标）：由同一类物质组成，具有足够表面粗糙度的目标区域。其**回波中没有主导地物**，因此会形成**光斑效应：多个同类型物质分布随机，导致回波的初相位和振幅不同，出现周期性的强弱变化，在图像上形成一系列亮暗相间的图斑**


- 点目标：比分辨单元小得多的地物目标，即在一个像素所对应的地块内比较小的独立地物目标。它与周围的地物不是同一类型，其**散射回波与周围地物不一样**，回波信号强时在整个地块的回波中**占据主导地位**，这也会形成**光斑效应：点目标的回波在图像上过于突出，形成光斑**


- 硬目标：既不占有相当面积，又不限制在分辨单元之内的地物，它们能**产生很强的回波信号，进而产生一系列亮点和一定形状的亮线**

##### 角反射效应
角反射器：地物目标具有两个或三个相互垂直的光滑表面

角反射效应：当雷达波束遇到角反射器时，地物的每个表面发生镜面反射使得波束反转$180\degree$，向来波方向传播，反射回去时这些方向和相位相同的回波间信号相互增强，产生极强的回波
- 二面角反射器：雷达图像上出现相当于二面角的两个平面之间交线的**亮线**
- 三面角反射器：雷达图像上出现相当于三个面之间交点的**亮点**


# C5. 遥感图像认识
## 5.1 遥感图像实质
遥感图像本质上是**对二维空间上连续型能量强度进行离散化采样并量化后的表示**，离散化主要体现在将连续能量强度转换为一个个离散的像元值的过程，也就是采样过程；量化就是对像元的辐射能量值进行数字化（亮度表示）

采样决定了图像的空间分辨率：用一个网格把待处理图像覆盖，把每一小格中的亮度取平均值，作为该小方格的值（小范围内的平均辐射值）
量化则是将采样过程中获得的像元平均值按照一定的编码规则划分为若干等级，划分方式可以是均匀的也可以是不均匀的，等级总数称为量化级数

- 量化级数一定时，采样点数越多，图像质量越好；越少，块状效应则越明显
- 采样点数一定时，量化级数越多，图像质量越好；越小，图像假轮廓效应越明显（二值图像）

## 5.2 遥感图像存储
共有三种存储形式：
- BIP：**按像元顺序记录图像数据，即在一行中按每个像元的波段顺序排列数据，使得各个波段同一位置上的像元排列在一起**，是一种像元交叉记录的数据格式
- BSQ：**按波段顺序记录图像数据，每个波段作为独立文件存放**，需要对一个波段的数据进行处理时最方便
- BIL：**按扫描行顺序记录图像数据，即先记录每个波段的第一行，然后第二行...**，只有所有波段数据读取结束后，才能生成完整图像

## 5.3 图像的颜色
### 5.3.1 真彩色、假彩色、伪彩色
1. **真彩色 (True Color)**
- **定义**: 真彩色图像是将遥感影像中可见光波段（红、绿、蓝）的信息分别对应到图像的红、绿、蓝三个通道（RGB）上，与人眼看到的地物颜色一致，适用于对可见光成像的传感器，但无法体现人眼不可见的波段信息

2. **假彩色 (False Color)**
- **定义**: 假彩色图像通过**将不可见波段（如近红外、短波红外）映射到红、绿、蓝三个可见光通道上来表达**。常见的组合是将近红外映射为红色，红光为绿色，绿光为蓝色。通过不同波段的组合，**用于强调特定信息（如植被、土壤、建筑等）**

 3. **伪彩色 (Pseudocolor)**
- **定义**: 伪彩色图像通过**对单波段或多个波段的数据进行灰度变换，将像素值用特定的颜色梯度表示**（如从低值到高值用蓝-绿-黄-红过渡）。**色彩与实际的光学反射或辐射特性无关，通常用于表示一个波段或参数的强度分布**

### 5.3.2 颜色的性质
颜色是人的视觉系统对可见光的感知结果，感知到的颜色由光的波长决定
区分颜色的三个特性是**色调、饱和度和明度**

#### 明度
人眼对光源或物体明亮程度的感觉，它和电磁波辐射亮度的概念不同，会受到人的视觉感受性和经验影响
**物体反射率越高，明度越高；光源亮度越大，明度越高；黑白图像灰度越趋于白，明度越高**

#### 色调
色彩彼此间相互区分的特性，因为**可见光波段的不同波长刺激人眼产生了不同色彩的感受**
每种颜色对应一个波长值，是**光谱色**；而有一些颜色，其刺激人眼的光波**是多种波长的组合**，它们不是光谱色

#### 饱和度
指的是彩色光所呈现颜色的纯洁程度，即**光谱中的波长段是否窄，频率是否单一**
对于光源，发出单色光，就是最饱和的彩色；对于物体，若物体对光谱反射性有很高的选择性，只反射很窄的波段，那么饱和度高。若混有白光或其他波长的光，饱和度变低

**黑白色只使用明度表述，不用色调和饱和度表述**

### 5.3.3 颜色空间
通常使用三维坐标来表示颜色空间
- 色调-饱和度-明度颜色空间
- 红-绿-蓝三原色颜色空间：若两种颜色混合产生白色或灰色，称其为互补色
- 颜色空间之间可以相互转换

# C6. 遥感图像误差校正处理
## 6.1 遥感影像质量评价
### 6.1.1 查看直方图
将遥感影像各个像元的亮度进行统计，并且绘制为**亮度区间-像元数的直方图**
当像元亮度是随机分布的时候，影像的直方图应该近似于正态分布
图像偏暗，则直方图的峰值偏向亮度轴的左侧；偏亮则偏向右侧。如果峰值提升过陡、过窄，说明图像像元亮度过于集中在某一区间

### 特征空间
每个像元都可表示为一个n维空间的点，空间的维度是组成图像的不同波段值，相似的地物可以表现为空间中的一个个点群。用欧氏距离、绝对距离、马氏距离、明斯基距离等距离相似性度量可以聚类

### 6.1.2 光谱特征的单波段统计量
对于单个的波段，我们可以采用下面的方式进行统计：
- 像元值：影像中像元的灰度值，它反映了该像元对应位置范围的光谱特性
- 灰度均值：反应图像中地物的平均反射强度
- 灰度中值：灰度级中处于中间的值，是统计量，而不是像元值
- 灰度众数：出现次数最多的像元值，反应图像中分布较广的地物
- 灰度方差：反应像元值的分散程度
- 灰度标准差：同灰度方差，反应信息量的多少
- 灰度数值域：灰度值的变化范围

波段间的协方差：
- 数学表达式： 
  $\text{Cov}(X, Y) = \frac{1}{n-1} \sum_{i=1}^n \left( X_i - \bar{X} \right) \left( Y_i - \bar{Y} \right)$   其中，X 和 Y 是两个波段的像素值，$\bar{X}$ 和$\bar{Y}$ 分别是其均值
如果协方差为正，说明两个波段的像素值有相同的变化趋势；如果为负，说明趋势相反；接近零则表明无关

波段间的相关系数：
-  数学表达式：
   $r(X, Y) = \frac{\text{Cov}(X, Y)}{\sigma_X \sigma_Y}$​    其中，$\sigma_X$ 和 $\sigma_Y$分别是波段 X 和 Y 的标准差。
与协方差不同，相关系数的取值与像素值的单位无关，更易于跨波段比较。范围在-1到1之间

## 6.2 遥感图像的辐射校正
### 6.2.1 辐射畸变
指遥感传感器在接收来自地物的电磁波辐射能时，电磁波在大气中传输和遥感器测量中受到传感器本身特性、地物光照条件（地形和太阳高度角）以及大气作用等影响，而导致的**遥感传感器测量值与地物实际的光谱反射或辐射率的不一致**

为了去除辐射畸变，要进行辐射校正以去除这些因素的影响。包括下面几个方面：

### 6.2.2 辐射定标（传感器定标）
将图像（像元亮度值或灰度值）数字量化值(DN值) 转换为**辐射亮度值或反射率或表面温度等物理量**，这个处理过程就是辐射定标，用于消除传感器本身的误差

遥感数字图像的DN值反应的是**对应的地表地物辐射能力的差异，是相对的，没有实际物理意义**，而在分析时，例如用户需要计算地物光谱反射率或辐射亮度时，就**需要将DN值转换为辐射亮度**
也就是将DN值转换为**大气外层表面传感器入瞳处的辐射亮度或反射率**的过程
它的目的是**消除传感器本身的误差**

传感器定标分为：
- 绝对辐射定标：建立传感器测量的数字信号与对应辐射能量之间的数量关系，包括卫星发射前后的绝对定标
  分为：实验室定标、星上定标和场地外定标三种方式，基本公式为：
  $$ L = Gain\times DN+bias$$
  其中Gain是传感器的增益系数，bias是传感器的偏移系数，DN为像元的亮度值，L则为传感器入瞳处的辐射能量。传感器的各定标系数从对应遥感图像的头文件中获取

- 相对辐射定标：又称**传感器探测元件归一化**，是为了校正传感器的各个探测元件响应度差异而对卫星传感器测量到的原始亮度值进行归一化的处理过程

## 6.3 遥感图像的大气校正
大气对经过其中的电磁能，有吸收、散射与发射作用，对传感器成像造成影响。主要由大气散射造成
大气校正即**消除大气散射所引起的辐射误差的过程**

- 基于辐射传输方程的大气校正：利用电磁波在大气层中的辐射传输原理，通过建立模型的方法实现大气校正。该方法需要确定大气参数：卫星几何参数、大气模式、气溶胶模式、传感器高度和目标高程、光谱条件等
- 基于线性回归经验模型的大气校正：同步获取遥感图像上对应地物的灰度值及其卫星成像时刻相应的地面目标反射光谱的测量值，建立两者这件的线性回归方程：
  $$ L = a+bR$$
  L为卫星观测值，R为地物的反射率，a是常数，即大气影响，b是回归系数，bR就是没有受大气影响的地面实测值$L_G$，所以有：$L_G=L-a$，这就是线性回归大气校正的过程

- 相对校正模型——线性回归： 原理是**利用某些波段（例如长波段）受大气影响较小的特性，作为标准数据，通过与其他波段影像的对比分析，建立线性回归模型$\bar{Y}=a+b\bar{X}$，其中X是受影响小的波段数据均值，Y是受影响大的波段数据均值**，这样就可获得未受大气影响的$L_G=b\bar{X}=\bar{Y}-a$

- 相对矫正模型——直方图校正（**暗物体法**）：水体或阴影等物体的灰度值在某些波段应该为0，但由于大气散射导致图像上的这些物体灰度值不为0，这个值就是**辐射偏置量**


## 6.4 太阳高度角和地形坡度的辐射误差校正
### 1. 太阳高度校正
主要是**消除由太阳高度角导致的辐射误差，即将太阳光倾斜照射时获取的图像，校正成太阳光垂直照射条件下的图像**
太阳高度角可由成像时刻的地理位置、季节和时间确定：
$$ \cos\theta = \sin\phi\times\sin\delta \pm \cos\phi\times \cos\delta\times\cos\tau$$
其中$\phi$是成像区域纬度，$\delta$是成像时太阳纬度，$\tau$是成像区域经度与太阳经度之差（时角）

太阳高度校正通过**调整一幅图像内的平均亮度值实现**：
$$f(x,y)=\frac{g(x,y)}{\sin\theta}$$
$f(x,y)$和$g(x,y)$是直射时的图像，和倾斜照射时的图像
也可以使用：
$$ DN=DN^{'}\times\cos i$$
来进行校正，i是太阳天顶角

图像镶嵌时，对于多幅拍摄于不同时间的图像，太阳高度校正是必须的。其方法是选择其中一副图像作为标准图像，校正其他图像：
$$ DN^{'}=DN\times\frac{\cos i_1}{\cos i_2}$$
其中$i_1$为标准图像的太阳天顶角，$i_2$是待校正图像的太阳天顶角

### 2. 地形校正
主要是**消除由地表坡度产生的辐射误差，校正成类似平地辐射的效果**
利用地表法线向量与太阳入射向量之间的夹角进行校正：
$$ L_H = L_T \frac{\cos\theta_O}{\cos i} $$
其中$L_H$是水平表面观察到的辐射，$L_T$是在倾斜地形上观察到的辐射，$\theta_O$是太阳天顶角，i是太阳相对于像元法线的入射角
**地形校正需要区域的DEM（数字高程模型）数据**
对于高山峡谷地区的遥感影像，地形校正是必须的

# C7. 遥感影像几何处理

遥感图像的**几何畸变：在图像获取过程中，由于多种原因导致影像中地物目标的相对位置关系与实际不符的现象**
类型：
- 传感器成像方式（投影方式）
- 传感器姿态变化
- 地形起伏
- 地球曲率
- GSD不同（地面宽度的不同）
- 地球自转
- 传感介质的不均匀
几何校正就是消除几何畸变的过程
## 7.1 几何变化的原因分析
### 1. 传感器外方位元素的变化
传感器的外方位元素指的是**传感器成像时的位置$(X,Y,Z)$和姿态角$(\phi,\omega,k)$**
当外方位元素偏离标准位置而出现变动时，就会使图像产生变形，这种变形由地物点图像的坐标误差表示，**可以通过传感器的构像方程进行求解**
- 线性变化：出现$dX_s,dY_s,dZ_s,dk$引起的变形
- 非线性变化：出现$d\phi, d\omega$引起的变形

### 2. 地形起伏
地面存在起伏时，对于高于或低于某一基准面的地面点，其**在图像上的像点与其在基准面上垂直投影时的构像点之间存在直线位移**，也就是投影误差

### 3. 地球表面曲率的影响
主要表现在两个方面：
- **引起像点位移**：地球表面是曲面，当选择的地图投影面是地球的切平面时，地面点相对于投影平面点有一定高差，并在投影平面上产生一定像点位移
- **像元对应的地面宽度不等**：遥感图像沿扫描方向上的一组像元所对应的地面宽度并不相同：星下点像元对应的地面宽度最小，向两侧逐渐增大。当表面是曲面且传感器的总视场角较大时，会造成图像边缘区的地物在成像时被压缩显示

### 4. 地球自转
地球自转对瞬时成像（整个图像在瞬间一次曝光完成，例如常规框幅式摄影成像）没有影响，但是对于扫描成像这种**动态成像**，地球的自转会**导致造成图像产生平行错动**（在卫星扫描的过程中，地球本身也在运动）

### 5. 大气折射
大气层不是均匀的传输介质，密度随着高度增加而递减，因此会导致折射率的变化，电磁辐射传播的方向不再是直线，从而引起遥感图像中的像点位移

## 7.2 几何校正
几何校正：**从具有几何畸变的图像中消除变形的过程**
基本方法：先建立几何校正的数学模型，利用已知条件确定模型参数，根据模型对图像进行几何校正
基本环节：
- **像元坐标变换：通过模型对整幅图像的全部像元进行坐标变换，重新定位以达到纠正的目的**

- **像元亮度重采样：重新定位后的像元在原始图像中的分布是不均匀的，需要根据输出图像上各像元在输入图像上的位置，对原始图像按照一定规则进行亮度值的插值计算，构建新的图像矩阵**

像元亮度重采样的原因是，重新定位后的像元位置对应于原始输入图像上行列号非整数的坐标位置，无法正好对应于某个像元中心，因此需要按照某些规则，为其赋予合理的插值亮度

### 7.2.1. 选择校正模型
#### 1. 物理校正模型：共线方程
遥感图像的构像方程：地物点在图像上的坐标(x, y)和其在地面对应点的大地坐标(X, Y, Z)之间的数学关系
而**共线方程描述的就是影像坐标、地面坐标和外方位参数之间的关系**

#### 2. 通用校正模型：几何多项式校正方法
多项式纠正法：回避成像的空间几何过程，直接对图像变形的本身进行数学模拟，把遥感图像的总体变形看作是平移、缩放、旋转和更高次的基本变形的组合
使用形如$x=a_0+(a_1X+a_2Y)+(a_3X^2+a_1XY+a_5Y^2)+(a_6X^3+a_7X^2Y+a_8XY^3+a_9Y^3)\cdots$的多项式来进行变换，其中x, y为某像元的图像坐标，XY为纠正后同名点的地面坐标，其余均为多项式系数

### 7.2.2 确定输出图像边界
输出图像边界的**地面坐标值**，由**包括纠正后图像在内的最小长方形范围**来确定

### 7.2.3 选取控制点
选择在影像上可以分辨并能精确定位的地表位置作为控制点，可以来源于地形图、其他几何校正后的数字正射影像、GPS野外测量获取的GCP（地面控制点）坐标
例如人工地物、线性地物交叉点、不易随时间变化的目标等

多项式纠正法的精度与GCP的精度、分布、数量和纠正范围有关，GCP的个数不少于多项式系数的个数，位置精度越高越好，且GCP的分布应该在整幅图像上均匀分布
最小控制点数量为(n+1)(n+2)/2，n为多项式的次数
**根据选取的地面控制点，使用最小二乘法计算出纠正模型的参数，同时可以利用残差分析来评判选取控制点的好坏（均方误差RMS，即地面控制点坐标(x, y）和根据模型多项式计算的控制点坐标(x',y')两个坐标对应的差值平方和再开方）**

### 7.2.4 灰度重采样
主要分为三种方法：
#### 1. 灰度最近邻像元重采样
在原始输入图像中，选择中心距离重新定位后的像元（投影点）位置**接近的4个像元中最近的那个像元的亮度**作为纠正后输出图像中该像元的亮度
计算简单，但是会产生较大的位置偏移，可能造成输出图像中某些地物不连贯

#### 2. 灰度邻近像元双线性内插重采样
取投影点周围**四个相邻像元**的灰度，**按照距离赋予权值并根据各自权重计算输出像元的灰度值**
具有平均化的滤波效果，边缘受到平滑作用，但是破坏了原来的像元值，为后面地物光谱识别分类造成了物体

#### 3. 灰度临近像元双三次卷积重采样
获取与投影点**临近的16个像元**的灰度值，**使用三次卷积函数进行内插计算**，输出像元灰度值
对图像边缘有所增强，具有均衡化和清晰化的作用，但是也破坏了原来的像元值，且计算量较大

## 7.3 镶嵌处理
影像配准：将同一地区不同时间、不同传感器或不同条件下获取的两幅或多幅图像进行匹配、叠加
- 相对配准：多幅图像以其中一幅作为参考图像，其他图像与之配准。其坐标系是任意的
- 绝对配准：选择某个地图坐标系，将多幅图像变换到这个地图坐标系，实现坐标系的统一

镶嵌处理：对若干幅**互为邻接**的影像，通过几何镶嵌、色调调整、去重叠等处理，**拼接为统一的一幅数字影像**的过程

先镶嵌后校正和先校正后镶嵌都是可以的


# C8. 遥感影像增强处理
影像增强包括显示增强和运算增强，其目的是：
- 修改像元值从而改善影像的视觉效果，提高影像清晰度
- 转换影像到更适合人或及其解译与分析处理的形式
- 增强后的影像多用于定性分析解释，不适合定量反演

## 8.1 显示增强

显示增强是按照一定规则修改影像每个像元值，以提高影像的显示效果并突出所需信息的处理过程
### 8.1.1 对比度增强
对比度增强指的是通过改变影像灰度（亮度值）的分布形态，**扩展灰度分布区间，增加影像反差**
#### 1. 直方图拉伸
- 线性变换：将亮度值按照
  $$ g(x,y)=\frac{d-c}{b-a}[f(x,y)-a]+c$$
  其中\[a, b]是原图像f(x, y)的亮度值范围，\[c, d]是变换后的图像范围
  根据图像亮度的分布特点，有时候需要对原图像的像元在某些亮度值区间上进行拉伸或压缩，此时使用分段式线性变换即可

- 非线性变换：变换函数是非线性的，主要介绍下面两种：
  - 指数变换：$g(x,y)=b\times e^{a\times f(x,y)}+c$，特点是**对图像中高亮度区拉伸，低亮度区压缩**
  - 对数变换：$g(x,y)=b\times \log[a\times f(x,y)+1]+c$，特点是**对图像的高亮度区压缩，低亮度区拉伸**

#### 2. 直方图均衡化
也属于**非线性增强**的方法，实质上是**减少影像的灰度级以换取对比度的加大：原直方图上频数较小的灰度级被归入几个灰度级内**，如果有一些灰度级构成的影像细节比较重要，则采取局部直方图均衡化

做法：将原始图像的像元值做某种映射变换，使变换后图像亮度的概率密度呈均匀分布，使得像元亮度值区间得到扩展，从而增强图像的对比度
**一般不能用于提取纹理结构或生态物理方面的信息**

#### 3. 直方图匹配
将原影像的直方图变换为某种指定形状的直方图或某一参考影像的直方图。主要应用于有一副很好的影像作为标准的情况下对另一幅影像进行匹配

### 8.1.2 彩色显示增强
关于图像的色彩相关的内容已经在C5.3节中进行了介绍
对于单波段图像，我们可以为其不同灰度级范围中的像元赋上不同颜色，进行伪彩色显示，有利于增强它们之间的对比差异
对于多波段图像，有时候我们也会采取和其真彩色显示不同的假彩色显示，用于突出某些上的特定地物

### 8.1.3 图像滤波
是一种采用滤波级数实现图像增强的方法，目的是突出或抑制某些图像特征，它结合周边相邻像元上下文进行运算
分为空间域滤波和频率域滤波

#### 空间域滤波
以像元和周围邻域像元的**空间关系**作为基础，通过**卷积运算**实现图像滤波的一种方法，主要分为平滑和锐化两种

其过程主要是：通过选定的卷积函数，在空间域上对图像作局部检测的运算：从图像的左上角开始，开一个和模板一样大小的活动窗口，按照模板函数的运算对窗口内的像元值进行计算，并用计算结果代替窗口中心的像元亮度值

##### 1. 均值平滑
也就是对整个区域内的像元值求均值，赋给中心像元：
$$ \frac{1}{9}\times \begin{bmatrix}
1 & 1 & 1\\
1 & 1 & 1\\
1 & 1 & 1
\end{bmatrix} $$
根据需要，也可以将某些位置化为0，排除某些位置的像元

简单，计算速度快，但是破坏了像元原始值，在去除噪声的同时会使得图像变得模糊

##### 2. 中值平滑
取整个区域内像元值的中值，赋给中心像元
在抑制噪声的同时，有效保留了图像中的边缘信息，相对减小了图像的模糊度

##### 3. 罗伯特梯度锐化
地物在边缘处往往存在亮度的剧烈变化，这体现在数值上就是**亮度梯度值较大**
因此，当找到了亮度梯度值较大的位置，说明找到了地物的边缘。图像处理时，**使用亮度梯度值代替原始图像的亮度值，生成梯度图像，实现图像的锐化**
罗伯特梯度法：

$$ \begin{align}
t_1 = \begin{bmatrix}
1 & 0\\
0 & -1
\end{bmatrix} ,
t_2 = \begin{bmatrix}
0 & -1\\
1 & 0
\end{bmatrix} \\
\\
|gradf(x,y)|=|t_1|+|t_2|
\end{align} $$

其含义是：**在图像上开一个2x2的窗口，分别用t1和t2模板对图像作卷积运算，并把运算后的绝对值相加，作为窗口==左上角==的像元的梯度值**

使用交叉差分的方法检测出像元与其邻域在上下、左右或斜方向的梯度差异，提取边缘信息

##### 4. sobel梯度锐化
在罗伯特梯度法的基础上，对卷积模板进行的改进，扩充为3x3的窗口范围
常用的卷积模板：
$$ t_1 = \begin{bmatrix}
1 & 2 & 1\\
0 & 0 & 0\\
-1 & -2 & -1
\end{bmatrix}, \quad t_2 = \begin{bmatrix}
-1 & 0 & 1\\
-2 & 0 & 2\\
-1 & 0 & 1
\end{bmatrix}$$

注意，梯度模板中的各个元素之和为0，这是因为对于均质区域来说，梯度值应该接近0

##### 5. 拉普拉斯算法
其意义是检测亮度值变化率的变化率，相当于二阶微分
模板：
$$ t =\begin{bmatrix}
0 & 1 & 0\\
1 & -4 & 1\\
0 & 1 & 0
\end{bmatrix} $$
#### 频率域滤波
通过某些数学变换（例如傅里叶变换），将一副图像像元值在空间上的变化分解为具有不同振幅、空间频率和相位的简振函数的线性叠加，对图像变换的频率成分直接进行运算后逆变换回空间域，以获得图像的增强效果

图像的边缘和噪声对应于频率域的高频部分，采用低通滤波可使图像平滑、去除噪声；采用高通滤波则锐化图像，抑制低频分量

## 8.2 多影像运算增强
一副多光谱影像，会有多个不同波段；一个区域的影像，会有多个拍摄时间不同的影像，这都是多影像
通过对多个输入影像的对应像元逐个进行四则运算，产生具有增强效果的影像，就是多影像的运算增强

### 8.2.1 影像差值运算
将两幅相同行列数的图像，对应像元值相减，就是差值运算
两个波段影像相减，反射率差值大的被突出出来，有利于**提取目标与背景反差较小的信息**

### 8.2.2 影像比值运算
$$ f(x,y)=\frac{f_1(x,y)}{f_2(x,y)}$$
将两幅图像的对应像元值相除，能够增强图像中的特定区域，消除或降低地形导致的阴影对图像的影响

对增强和区分在不同波段差异较大的地物有明显的效果；对于去除地形影响也十分有效，在一定程度上消除“同物异谱”的现象

### 8.2.3 应用：植被指数
基于植被叶绿素**在==红色波段R==的强烈吸收**，以及**在==近红外波段NIR==的强烈反射**，通过将这两个波段的图像进行比值或线性运算，实现对植被的分析

- 归一化植被指数NDVI：
$$ NDVI = \frac{NIR-R}{NIR+R} $$
  这是一种标准化的植被指数，其值在-1到1之间，是反映农作物长势和营养信息的重要参数之一

- 比值植被指数 $SR = \frac{NIR}{R}$
- 土壤修正植被指数$SAVI=(1+L)\times \frac{NIR-R}{NIR+R+L}, L=0.5$

## 8.3 多光谱变换
多光谱图像的各波段数据之间常常**具有不同程度的相关性，存在一定的冗余数据**。
多光谱变换通过对多光谱图像进行函数变换，达到**保留主要信息、降低数据量、增强或提取有用信息**的目的

### 8.3.1 K-L变换（主成分变换PCA）
其基本思想是：通过寻找一组满足下列要求的新的特征（主成分），将原始数据转换到新的坐标系中，**使得新坐标系中各个主成分互相不相关，选取数据集中程度最高的一些主成分方向**，进而实现删除冗余信息的目的
- 每个主成分的方差最大
- 主成分之间是不相关的（相互正交）

也就是通过$Y=AX$，其中Y是变换后的数据，A是主成分的特征矩阵，X是原数据，进行变换

基本过程：
- 数据标准化：主成分变换对特征尺度敏感，若原始数据上的各个分量的尺度不同，会导致结果受到很大影响，因此需要通过$X_s = \frac{X-\mu_X}{\delta}$的方式将各个分量变换至方差为1，均值为0的尺度内
- 计算协方差矩阵：协方差矩阵衡量每个特征之间的相关程度，协方差越大，相关性越小
- 计算协方差矩阵的特征向量，然后计算特征值：特征向量是经过矩阵作用后，保持不变的方向向量，也就是变换坐标系的基，相互不相关。通过计算协方差矩阵，我们获得了所有的主成分
- 选择较大的特征值所对应的方向：特征值越大的主成分，表示该方向上的数据变异性越大，我们只需要选择大小较大的前几个分量，就能获得数据集中程度最大的一些方向，进而提取出主要的信息，忽略冗余信息
- 对每个像元按照主成分

几何上，变换后的主分量空间的坐标系相当于将原来的多光谱空间坐标系旋转至主分量方向，并且新的坐标轴指向数据最密集的方向，忽略掉方向中数据较少的部分，实现数据压缩的目的

### 8.3.2 K-T变换（缨帽变换）
这也是一种将坐标空间进行旋转的变换，它针对多光谱数据与自然景观要素之间的关系而建立，变换的方向并非主成分的方向，而是与地物具有密切关系的方向，特别是对于植物生长过程与土壤有关
缨帽变换的变换矩阵随不同数据而不同，对于得到的多个新的分量中，仅有前三个分量与地物具有明确的对应关系，分别是：$亮度Y_1、绿度Y_2、湿度Y_3$

Y1-Y2：植被视面； Y2-Y3：土壤视面；Y1-Y3：过渡区视面

## 8.4 多源数据融合
遥感信息融合：将同一区域内多种遥感平台、多时相遥感数据之间以及遥感数据和非遥感数据之间的信息组合匹配的技术

多源遥感数据融合的过程包括图像选择、图像配准和图像融合三个环节
图像选择方面，理论上对于任何类型的遥感图像都可以进行融合，在实际应用时，选取多种遥感平台、多时相遥感数据之间以及遥感数据和非遥感数据之间的信息组合，都可以

影像配准在镶嵌时已经叙述了

影像融合：将不同类型传感器获得的同一地区数据进行空间配准后，将各数据中的优势或互补性有机结合起来产生新数据的技术过程。目的是保留光谱信息和提高几何特征

- 主成分变换融合：先对输入的多光谱遥感数据进行主成分变换，变换后的第一主成分包括了变换前各个波段的图像的相同信息，**再将高空间分辨率的遥感图像替代第一主成分**，逆变换回原图像，就获得了具有高分辨率的多光谱融合图像
- IHS变换融合：将用RGB空间表示的遥感图像的三个波段变换至IHS空间（亮度、色度、饱和度），用空间分辨率较高的遥感波段图像代替其中的I值，再反变换回RGB空间
- 加权融合算法：将待融合图像上的每个同名像元进行加权组合，生成一副新的融合图像



# C9. 目视解译

==**目视解译==：专业人员根据影像所呈现的各种规律，通过直接观察或借助仪器与相关资料，采用一定方法对影像进行分析判断，确认其地物属性、特征的过程**

## 9.1 判读标志
指的是遥感图像上能够帮助人们识别不同目标的那些影像特征
直接：能在遥感影像上直接看到的可供判读的影像特征
间接：运用某些直接判读标志，结合地学知识，间接推断出的影像标志

### 9.1.1 光谱类判读标志
地物的波谱响应曲线与其光谱特性曲线一致，地物在多波段图像上特有的这种波谱响应就是地物的光谱特征的判读标志
- 色调/颜色：灰阶或色别与彩色，是最重要、最直观的判别标志

### 9.1.2 空间特征类判读标志
景物的各种几何形态就是其空间特征，与物体的空间坐标X，Y，Z密切相关，在像片上也是由不同的色调中表现处理的
目标地物和背景之间必须存在能够被人的视觉所分辨的色调差异，才能区分出目标

- 形状：各种地物的外形，从高空观测地面物体，就是其在二维X-Y平面上的投影
- 大小：地物的尺寸、面积、体积在图像上按比例缩小后的相似性记录。必须**考虑图像的空间分辨率和比例尺**
- 图形：自然或人造地物所构成的图形
- 图案：目标地物有规律排列而成的图形结构，是综合性判读标志——人工地物具有某种特殊图形
- 纹理：图像上的细部结构，以一定频率重复出现，是单一特征的集合
- 位置：地物分布所处的地点与环境，地物与周边的关系
- 布局：物体间的空间配置，形成一定的位置关系和排列方式

### 9.1.3 间接判读标志
许多问题无法从目视解译中直接获取答案，需要从其他相关事物之间的联系，通过逻辑推理获得判断，这就是间接判读
所采取的依据就是间接判读标志

特点是灵活、变化、难有规律可循，需要更丰富的知识背景和严密的逻辑推理，是一种综合的分析方法

## 9.2 判读一般方法
### 9.2.1 直接判读法
直接从影像中判读出所需信息

### 9.2.2 对比分析法
多波段/同类地物/多时相/空间对比分析，将多幅遥感影像进行对照解译

### 9.2.3 信息复合法
利用透明专题图或透明地形图与遥感图像复合，根据其提供的多种辅助信息，识别遥感图像上的目标地物

### 9.2.4 综合推理法
综合考虑遥感图像中多种解译特征，结合生活常识对某种目标地物进行分析、推断

## 9.3 目视解译一般过程

1. 了解影像的辅助信息：熟悉其平台、传感器、成像方式等信息，了解可判读程度
2. 分析已知专业资料
3. 建立解译标志
4. 预判读：根据判读标志进行勾绘类型界线、标注地物类别、形成预判读图等影像判读工作
5. 地面实况调查：预判读的图件不可避免会出现错误，此时需要野外实地调查与验证
6. 详细判读：根据调查结果，修正预判读图中的错误，确定未知类型，进行细化，得到正式的判读原图
7. 类型转绘与制图：将判读原图上的类型界线转绘到地理底图上，根据需要进行着色等工作，形成正式的专题地图

## 9.4 影响判读的因素
遥感图像解译是一个复杂的过程，主要体现在：
- 地物波谱特征受多种因素控制，本身也因时因地变化
- 自然界中存在大量同物异谱或同谱异物现象
- 地物各要素、类别之间存在复杂的多种类型地带性规律


# C10. 遥感图像计算机识别分类
遥感图像的另一种方法是通过计算机方法进行识别和分类
基本前提：同类地物在相同的条件下，应该具有相同或相似的光谱信息特征和空间信息特征，从而表现出同类地物某种内在的相似性——同类地物像元的特征向量会集群在同一特征空间区域；不同地物则会集群在不同特征空间区域

## 10.1 基于光谱特征的分类原理
依据是**遥感图像中像元向量的相似度，常常使用距离和相关系数进行衡量**
距离：欧氏距离、绝对距离、马氏距离、明斯基距离
相似系数：两个向量之间的夹角余弦（余弦相似度），通过点乘除以模长之积计算

### 10.1.1 特征变换和特征选择
常用的特征提取变换：主分量变换、缨帽变换、比值变换等
特征选择的定量方法：相关系数法、距离测度、散布矩阵测度

### 10.1.2 监督分类
选择具有代表性的训练区，使用其中已知地面各类地物样本的光谱特性来训练模型，获得识别地物的判别函数或模式，并且对未分类地物进行分类处理

主要步骤：确定类别数->选择训练样本区->选择合适的分类算法->分类精度评价

#### 1. 选择样本区
训练场地应该满足：
- 光谱特征较为均一，可以选取多块场地
- 样本数目应满足建立分类判别函数的至少要求，对于光谱特征变化较大的地物，训练样本应该更多一些

#### 2. 主要的监督分类方法
最大似然分类法：根据贝叶斯准则进行分类，它**要求训练样本数据在特征空间近似服从正态分布**
- **先验概率**$P(k)$：类别$k$的先验概率通常可以通过训练集的频率估计得到，即类别$k$在样本中的出现频率：
    $$P(k) = \frac{n_k}{n_{\text{total}}}​​$$
    
    其中，$n_k$是类别$k$的样本数，$n_{\text{total}}$是所有训练样本的总数。


- **条件概率**$P(x|k)$：假设数据在每个类别下服从高斯分布，类别$k$的条件概率密度函数为：

$$P(x|k) = \frac{1}{(2\pi)^{p/2} |\Sigma_k|^{1/2}} \exp\left( -\frac{1}{2} (x - \mu_k)^T \Sigma_k^{-1} (x - \mu_k) \right)$$

这个公式表示了给定类别$k$时，样本$x$在该类别下的概率分布。$p$是特征空间的维度，$\mu_k$是类别$k$的均值向量，$\Sigma_k$是类别$k$的协方差矩阵。

- **后验概率**$P(k|x)$：通过贝叶斯公式可以得到类别$k$的后验概率：

$$P(k|x) \propto P(x|k)P(k)$$

其中，$P(x|k)$是条件概率，$P(k)$是先验概率，比例常数$P(x)$在不同类别间是一样的，因此可以忽略。

- **决策规则**：最大似然分类的决策规则是选择使后验概率$P(k|x)$最大的类别$k$：

$$k^* = \arg\max_k \left( P(x|k) P(k) \right)
$$
由于对数函数是单调递增的，可以取对数，得到简化的决策规则：
$$k^* = \arg\max_k \left( \log P(x|k) + \log P(k) \right)$$
这可以通过计算每个类别的概率密度和先验概率来得到。


总的来说，该方法**通过统计各个类别的出现频率，计算出先验概率，根据数据正态分布的假设，获得数据属于每个类别k的条件概率，然后根据贝叶斯法则计算出后验概率，将待分类对象分配给计算所得到后验概率最大的那个类别中**


监督分类法的优点：根据应用目的和区域，能够有选择地确定分类类别，并且控制样本的选择，及时检查和更改训练样本，避免分类错误，具有较高的精度和速度
缺点：训练样本代表性不足，人力消耗大，无法识别和分类未知的类别

### 10.1.3 非监督分类
根据事先指定的某一准则，进行自动判别归类，分类完成后需要确定地物类别的名字等信息。
主要采用**聚类法**
聚类准则：使同一类别像元间的距离尽可能小，不同类别的像元之间的距离尽可能大

#### 0. 最近邻
最近邻算法的基本思想是将数据点分配给离它最近的“类别中心”或“簇”。与K-均值不同，最近邻通常不要求预设簇的数量，而是根据某些度量（例如欧氏距离）将数据点分配到最近的类别


#### 1. K-均值法
过程：确定聚类的组数；选取k个接近的对象，计算出组内的中心，对于每个像元，计算其与这个中心的距离，将像元归类到距离最小的中心的那个组中，然后根据加入像元继续使用k-均值调整中心位置，重复这个过程，直到中心不再发生变化或达到预设的迭代次数

基本原理：
1. **初始化**：随机选择K个数据点作为初始簇中心。
2. **分配样本**：根据每个样本与K个簇中心的距离，将每个样本分配给最近的簇。
3. **更新中心**：计算每个簇内所有样本的均值，并将簇中心更新为该均值。
4. **重复迭代**：不断重复步骤2和3，直到簇中心不再发生变化或达到预定的迭代次数。

初始的聚类中心会影响聚类的结果

#### 2. ISODATA迭代自组织数据分析技术
ISODATA算法是K-均值的扩展，结合了聚类和迭代自组织数据分析的思想。ISODATA（迭代自组织数据分析）不仅可以调整簇的数量，还能够动态合并和分裂簇，以便更好地适应数据的分布。它常用于遥感图像、地理数据等领域，能够自动地调整簇数，使其更符合数据的内在结构。

基本原理：
1. **初始化**：与K-均值相似，随机选择初始簇中心，指定簇的最小数目和最大数目。
2. **分配样本**：将每个样本分配给最近的簇，计算簇内的均值。
3. **合并簇**：如果两个簇之间的距离小于某个阈值，则合并这两个簇。
4. **分裂簇**：如果某个簇的样本数超过预设的阈值，则将该簇分裂成两个簇。
5. **更新中心**：根据分配的样本更新簇中心。
6. **迭代**：重复上述步骤，直到簇不再变化或满足某个终止条件。

非监督聚类优点：不需要预先对待分类区域有广泛了解，人工参与需要较少，小的类别能被区分开来
缺点：盲目聚类，计算速度慢，难以对得到的类别进行控制


## 10.2 分类后误差分析
### 10.2.1 混淆矩阵
对于二分类问题，混淆矩阵通常如下所示：

||**预测为正类**|**预测为负类**|
|---|---|---|
|**真实为正类**|真阳性 (TP)|假阴性 (FN)|
|**真实为负类**|假阳性 (FP)|真阴性 (TN)|

其中：

- **真阳性**（TP, True Positive）：分类器正确地将正类预测为正类的样本数。
- **假阳性**（FP, False Positive）：分类器错误地将负类预测为正类的样本数。
- **真阴性**（TN, True Negative）：分类器正确地将负类预测为负类的样本数。
- **假阴性**（FN, False Negative）：分类器错误地将正类预测为负类的样本数。

对于多分类问题，混淆矩阵会扩展为一个$n \times n$的矩阵，其中行表示实际类别，列表示预测类别，每个元素$M_{ij}$表示实际类别$i$被预测为类别$j$的次数。

#### 例子：

假设一个三类分类问题，混淆矩阵如下：

||类1预测|类2预测|类3预测|
|---|---|---|---|
|**实际类1**|50|10|5|
|**实际类2**|8|45|7|
|**实际类3**|3|6|60|

在这个矩阵中，我们可以看到不同类别之间的预测情况。比如，实际类1有50个样本被正确分类为类1，但也有10个样本被误分类为类2

### 10.2.2 用户精度
**用户精度**（User's Accuracy，UA）是衡量分类器对某一类预测结果的可靠性的指标。具体来说，它衡量的是预测为某一类别的像素中，实际上属于该类别的比例。公式为：

$$\text{用户精度} = \frac{\text{真阳性（TP）}}{\text{真阳性（TP）} + \text{假阳性（FP）}}$$

- **含义**：用户精度高意味着分类器对该类别的预测较为准确，假阳性较少。即，如果分类器预测某一类，真实属于该类的概率有多大。

### 10.2.3 生产者精度
**生产者精度**（Producer's Accuracy，PA）衡量的是分类器能够识别某个类别的能力，即在所有实际属于某一类别的样本中，分类器正确预测为该类别的比例。公式为：

$$\text{生产者精度} = \frac{\text{真阳性（TP）}}{\text{真阳性（TP）} + \text{假阴性（FN）}}$$

- **含义**：生产者精度反映了该类别样本在整体分类中的被正确分类的比例。即，实际属于某一类的样本中，分类器正确预测的比例有多大。

### 10.2.4 kappa系数
Kappa系数的计算公式为：

$$\kappa = \frac{P_o - P_e}{1 - P_e}$$

其中：

- **$P_o$**：观察到的准确度（observed accuracy），即从混淆矩阵中直接计算的分类精度：
    
    $$P_o = \frac{\sum_{i} M_{ii}}{N}$$
    
    其中，$M_{ii}$是混淆矩阵中第$i$类的真阳性，$N$是样本总数。
    
- **$P_e$**：预期准确度（expected accuracy），即在假设分类是完全随机的情况下，类别正确分类的概率。通过计算每个类别的先验概率来得到：
    
    $$P_e = \sum_{i} \frac{(\text{row sum}_i) \times (\text{column sum}_i)}{N^2}$$
    
    其中，“row sum”是第$i$行的总和，“column sum”是第$i$列的总和，$N$是样本总数。


# 遥感综合应用的主要步骤
- 问题的界定
- 根据项目需求，选择合适的影像
- 时空谱特征分析
- 构建地物分类方法
- 地物提取与精度验证
- 结果展示



|     | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 1   | 0   | 80  | INF | 95  | INF | 60  | INF | INF | INF | INF |
| 2   | 80  | 0   | 30  | 20  | 80  | 60  | 140 | 150 | 80  | 40  |
| 3   | INF | 30  | 0   | 60  | 30  | INF | INF | INF | 40  | INF |
| 4   | 95  | 20  | 60  | 0   | 50  | 80  | INF | 30  | INF | INF |
| 5   | INF | 80  | 30  | 50  | 0   | INF | INF | 60  | INF | INF |
| 6   | 60  | 60  | INF | 80  | INF | 0   | 20  | INF | INF | 40  |
| 7   | INF | 140 | INF | INF | INF | 20  | 0   | INF | INF | 40  |
| 8   | INF | 150 | INF | 30  | 60  | INF | INF | 0   | INF | INF |
| 9   | INF | 80  | 40  | INF | INF | INF | INF | INF | 0   | 20  |
| 10  | INF | 40  | INF | INF | INF | 40  | INF | INF | 20  | 0   |

{
{ 0, 80, INF, 95, INF, INF, INF, INF, INF, INF}, 
{ 80, 0, 30, 20, 80, 60, 140, 150, 80, 40}, 
{ INF, 30, 0, 60, 30, INF, INF, INF, 40, INF},
{ 95, 20, 60, 0, 50, 80, INF, 30, INF, INF},
{ INF, 80, 30, 50, 0, INF, INF, 60, INF, INF},
{ 60, 60, INF, 80, INF, 0, 20, INF, INF, 40},
{ INF, 140, INF, INF, INF, 20, 0, INF, INF, 40},
{ INF, 150, INF, 30, 60, INF, INF, 0, INF, INF},
{ INF, 80, 40, INF, INF, INF, INF, INF, 0, 20},
{ INF, 40, INF, INF, INF, 40, INF, INF, 20, 0}
};