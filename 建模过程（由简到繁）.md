
建模思想：现有的数据量和精度不足以总结出一个可靠的数学模型用于描述从森林到农田的生态系统的演化过程，因此我们通过一些基础的假设和已有的随机模型，进行这样的**生态系统的仿真**，将仿真结果进行可视化分析，与现有的文字资料进行比对，就可以对模型的可行性进行评估

设$X(t)=(x_1(t), x_2(t), \cdots, x_d(t))$为物种集合1，各个元素是其中物种的种群数量

$Y(t)=(y_1(t), y_2(t),\cdots, y_d(t))$为与集合1进行交互（合作和竞争，或捕食）的相应物种集合2

# 1. 基本模型：随机Lokta-Volterra模型

## 1.1 捕食模型
对次级捕食者-初级捕食者；初级捕食者-生产者等具有捕食关系的物种，采用竞争模型

$$\begin{cases}
\frac{dX(t)}{dt}&=(\alpha_x​X(t)−\gamma_1X(t)X(t))+\sigma_1​X(t)W(t)\\
\frac{dY(t)}{dt}&=(-\alpha_y​Y(t)+\gamma_2​Y(t)X(t))+\sigma_2​Y(t)W(t)
\end{cases}$$

- $\alpha_x$表示被捕食者无天敌情况下的增长率，$\alpha_y$则是捕食者无食物情况下的自然死亡率
- $\gamma_1$表示物种被捕食概率
- $\gamma_2 = e\gamma_1$，e是捕食的猎物与新生捕食者的比率，即“捕食多少猎物，才能诞生一个捕食者”
- W(t)是随机扰动，用于模拟自然情况下的环境，$\sigma_1$和$\sigma_2$是物种受环境影响的程度

对于捕食率$\gamma_1$，我们采取响应函数$F(X(t))=\frac{aX(t)}{1+ahX(t)}$，即：
$$\frac{dX(t)}{dt}=(\alpha_x​X(t)−\frac{aX(t)}{1+ahX(t)}\cdot X(t)X(t))+\sigma_1​X(t)W(t)$$
其中：
- a是攻击速率，简单地假设为1
- h是捕食者消化一个猎物所需的时间
- $\gamma_2=e\cdot\gamma_1$，e也采用假设的值


## 1.2 竞争-合作模型
对于蝙蝠、益虫等对生产者有利的物种，采用以下的竞争-合作模型
$$ \begin{cases}
\frac{dX(t,a)}{dt}&=\alpha_xX(t)-\beta_1X(t)Y(t)+\omega_1X(t)Y(t)+\sigma_1​X(t)W(t)\\
\frac{dY(t)}{dt}&=\alpha_yY(t)-\beta_2X(t)Y(t)+\omega_2X(t)Y(t)+\sigma_2​Y(t)W(t)
\end{cases}$$


- $\beta$表示物种X和Y之间的竞争效应，大于等于0，小于等于1
- $\omega$表示X和Y之间的合作效应，大于等于0
- $\alpha$表示两个物种自然情况下的增长率（注意不是死亡率）


# 2. 引入生态承载量
洛吉斯蒂增长模型：
$$ \frac{dN}{dt} = \alpha \cdot N\cdot (1-\frac{N}{K})$$
其中N是种群数量，$\alpha$是内禀增长率，K是生态承载量
将K引入上述捕食模型和竞争-合作模型：

## 2.1 捕食模型：
$$\begin{cases}
\frac{dX(t)}{dt}&=X(t)(\alpha_x​−\gamma_1X(t))(1-\frac{X(t)}{K_1})+\sigma_1​X(t)W(t)\\
\frac{dY(t)}{dt}&=Y(t)(-\alpha_y+\gamma_2​X(t))(1-\frac{Y(t)}{K_2})+\sigma_2​Y(t)W(t)
\end{cases}$$

其中$K_1$和$K_2$是环境对于两个物种的承载量

## 2.2 竞争-合作模型
$$ \begin{cases}
\frac{dX(t)}{dt}&=X(t)(\alpha_x-\beta_1Y(t)+\gamma_1Y(t))(1-\frac{X(t)}{K_1})+\sigma_1​X(t)W(t)\\
\frac{dY(t)}{dt}&=Y(t)(\alpha_y-\beta_2X(t)+\gamma_2X(t))(1-\frac{Y(t)}{K_2})+\sigma_2​Y(t)W(t)
\end{cases}$$
其中$K_1$和$K_2$是环境对于两个物种的承载量

# 3. 引入季节因素和农业周期因素
## 3.1 季节因素
设$S(t)=1+\sin(\frac{2\pi t}{T}+\phi)$为季节影响因子，其中T是时间周期（一年）
季节因素可能影响增长率，即：
$$\alpha(t)=\alpha \cdot S(t)$$
其中$\alpha$是平均增长率，使用假设的值
同理死亡率$\beta(t)=\beta\cdot S_1(t)$

季节性还会影响生态承载量：
$$ K(t)=K\cdot S(t)$$
K是平均承载量，使用假设的值

季节性对捕食率$\gamma_1$也有影响：
$$ \gamma_1(t)=\gamma_1\cdot S(t)$$
## 3.2 农业周期因素

主要影响生产者中的作物部分，由于农业周期无法单纯以某个单一因子表示，因此我们采取下面这样的表示方法：
$$ \frac{dX^{'}(t)}{dt}=f(\frac{dX(t)}{dt})$$
其中f代表农业生产周期对变化速率的影响，具有如下的周期性：
- 土壤准备阶段：对于**生产者的环境承载量K**提升，提升的倍率由假设得到
- 生长和防治阶段：在这一阶段，开始**引入后面的除草剂、杀虫剂施用等影响因子**，并且采取一些有机农业的措施（改变方程得到）
- 收获阶段：作物的种群数量锐减90%，这部分数量作为收获产物
- 加工与售卖阶段：将加工产物进行出售，获得盈利

土壤准备阶段中，设经过n次土壤准备阶段，将对生产者的环境承载量K的提升效果也使用Sigmoid函数进行建模，即：
$$K(n)=K_0+\frac{K_{max}-K_0}{1+e^{-n}}$$


## 4. 引入除草剂和杀虫剂

化学药剂的剂量对药效的影响使用Sigmoid函数模拟：
$$ D(t)=\frac{D_0}{1+e^{-k_d(u(t)-u_m)}}$$
其中
- $k_d$为控制影响显著程度的因子，可以假设为1
- $D_0$为最大影响程度，化学药剂对各个物种均有影响，但是影响程度不同，通过这个值来控制
- $u_m$是开始生效的剂量
- $u(t)$是剂量控制函数，也就是对使用化学药剂的决策函数，之后的决策有效性依靠改变这个函数来观察哪种策略更好

化学药剂的作用因子通过在方程中引入一项$-N\cdot D(t)$来表示，其中N是对应种群的种群数量，根据种群类别的不同，采用不同的D(t)函数

## 4.1 除草剂

对于作物的影响较小，对于其他生产者的影响程度较大，不妨设对于作物的$D_0^{'}$是对于其他生产者的$D_0$的0.5倍或0.25倍。对于消费者的影响忽略不计

## 4.2 杀虫剂

对于害虫的影响较大，对于其他生物的影响忽略不计

# 4. 总结：完整的模型

我们假设：捕食关系对种群数量的影响和合作-竞争对种群数量的影响比值为0.7和0.3，其中被捕食和捕食的影响占整个捕食关系的一半
那么可以写出这样一个总的模型：

对于一个物种的种群数量$x_i(t)$，设捕食关系中其属于营养级为$X_1(t)=(x_1(t),x_2(t), \cdots,x_i(t),\cdots, x_m(t))$，相应的捕食者为$Y(t)=(y_1(t),y_2(t),\cdots,y_m(t))$
可能存在的被捕食者为$M(t)=(m_1(t),m_2(t),\cdots, m_m(t))$

设合作-竞争关系中其属于$X_2(t)=(x_1(t),x_2(t), \cdots,x_i(t),\cdots, x_n(t))$，相应的竞争者或合作者为$Z(t)=(z_1(t), z_2(t), \cdots, z_n(t))$

则有生产者（只被捕食，不捕食）种群数量：
$$\begin{align}
\frac{dX(t)}{dt}&=f\{0.7\cdot[ X(t)(\alpha_x​\cdot S(t)−F(X(t))\cdot S(t)\cdot X(t))(1-\frac{X(t)}{K_1\cdot S(t)})]\\ &+0.3\cdot[X(t)(\alpha_x\cdot S(t)-\beta_1Y(t)+\omega_1Y(t))(1-\frac{X(t)}{K_1\cdot S(t)})]+\sigma​X(t)W(t)\}
\end{align}$$

初级捕食者（可能捕食，可能被捕食）：
$$\begin{align}
\frac{dX(t)}{dt}&=f\{0.35\cdot[ X(t)(\alpha_x​\cdot S(t)−F_1(X(t))\cdot S(t)\cdot X(t))(1-\frac{X(t)}{K_1\cdot S(t)})\\
&+X(t)(-\alpha_x\cdot S(t)+e\cdot F_2(X(t))\cdot​M(t))(1-\frac{X(t)}{K_1})]\\ &+0.3\cdot[X(t)(\alpha_x\cdot S(t)-\beta_1Y(t)+\omega_1Y(t))(1-\frac{X(t)}{K_1\cdot S(t)})] +\sigma X(t)W(t)\}
\end{align}$$

次级捕食者（在我们的模型中为顶级捕食者）（只捕食）：
$$\begin{align}
\frac{dX(t)}{dt}&=f\{0.7\cdot[
X(t)(-\alpha_x\cdot S(t)+e\cdot F(X(t))\cdot S(t)\cdot M(t))(1-\frac{X(t)}{K_1})]\\ &+0.3\cdot[X(t)(\alpha_x\cdot S(t)-\beta_1Y(t)+\omega_1Y(t))(1-\frac{X(t)}{K_1\cdot S(t)})] +\sigma X(t)W(t)\}
\end{align}$$

上面的公式中：
- $\beta$表示两个物种之间的竞争效应强度，大于等于0，小于等于1
- $\omega$表示两个物种之间的合作效应强度，大于等于0
- $\alpha$表示两个物种自然情况下的增长率（注意不是死亡率）
- $e$表示捕食的猎物与新生捕食者的比率，即“捕食多少猎物，才能诞生一个捕食者”
- $F(X(t))=\frac{aX(t)}{1+ahX(t)}$为捕食响应函数
- $\sigma$衡量受环境影响的程度
- $W(t)$为随机扰动
- $S(t)=1+\sin(\frac{2\pi t}{T}+\phi)$是季节影响因子函数
$f$是农业周期影响函数，设一个农业周期时间为T，$P(t,K_1,X_i(t),\cdots)=\frac{dX_{原i}(t)}{dt}$为不考虑农业周期影响情况下的种群数量增长公式，其中t为时间，$K_1$为生态承载量；$X_i(t)$为所有种群中特定种群的种群数量，$i=1,2,3,4,5,6$
$$ X_i(t):\begin{cases}
作物种群的种群数量,\quad i=1\\
其他生产者的种群数量,\quad i=2\\
害虫的种群数量,\quad i=3\\
益虫的种群数量,\quad i=4\\
蝙蝠的种群数量,\quad i=5\\
其他次级捕食者的种群数量,\quad i=6
\end{cases}
$$
设$K(K_1,n)=K_1+\frac{K_{max}-K_0}{1+e^{-n}}$为农业周期对生态承载力的影响函数
$D(t)=\frac{D_0}{1+e^{-k_d(u(t)-u_m)}}$为化学药剂的影响函数，其中：
- $k_d$为控制影响显著程度的因子，可以假设为1
- $D_0$为最大影响程度，化学药剂对各个物种均有影响，但是影响程度不同，通过这个值来控制
- $u_m$是开始生效的剂量
- $u(t)$是剂量控制函数，也就是对使用化学药剂的决策函数，之后的决策有效性依靠改变这个函数来观察哪种策略更好

则：
$$ f(P(t,K_1,X_i(t),\cdots))=\begin{cases}
P(t,K(K_1,n),X_i(t),\cdots),同时令P(t,K_1,X_i(t),\cdots)=f(P(t,K_1,X_i(t),\cdots)), \quad当nT+t_1\leq t < (n+1)T+t_1，且i=1或2，其中n是经过的农业周期数，t_1是土壤准备阶段开始时刻\\
P(t,K_1,X_i(t),\cdots)-X(t)\cdot D_i(t),同时令P(t,K_1,X_i(t),\cdots)=f(P(t,K_1,X_i(t),\cdots)),\quad当nT+t_2\leq t\leq nT+t_3,其中t_2是防治阶段开始时刻，t_3是收获阶段开始时刻，D_i(t)为种群对应的化学药剂影响函数\\
P(t,K(K_1,n),0.1X_i(t),\cdots),同时令P(t,K_1,X_i(t),\cdots)=f(P(t,K_1,X_i(t),\cdots)),\quad 当t=nT+t_3,且i=1\\
P(t,K_1,X_i(t),\cdots),\quad 其他
\end{cases}$$


以下面的各个种群及其对应关系为基础，建立仿真程序：

1. 作物种群
   属于：生产者类
   捕食者：害虫
   被捕食者：无
   合作关系：蝙蝠、益虫
   竞争关系：其他生产者

2. 其他生产者
   属于：生产者类
   捕食者：害虫
   被捕食者：无
   合作关系：蝙蝠、益虫
   竞争关系：作物

3. 害虫
   属于：初级捕食者类
   捕食者：蝙蝠、其他次级捕食者
   被捕食者：作物、其他生产者
   合作关系：无
   竞争关系：种内竞争

4. 益虫
   属于：初级捕食者类
   捕食者：其他次级捕食者
   被捕食者：无
   合作关系：作物、其他生产者、蝙蝠
   竞争关系：害虫

5. 蝙蝠：
   属于：次级捕食者类
   捕食者：无
   被捕食者：害虫
   合作关系：作物、其他生产者
   竞争关系：其他次级捕食者

6. 其他次级捕食者：
   属于：次级捕食者类
   捕食者：无
   被捕食者：害虫、益虫
   合作关系：无
   竞争关系：蝙蝠


- 生产者与益虫、蝙蝠之间的合作关系更加显著
- 作物同其他生产者（包括原生生态系统中的生产者）之间存在竞争关系
- 蝙蝠对于害虫具有的捕食关系和对于生产者的传粉作用，使得蝙蝠的引入对生产者的生长具有良好的促进作用
- 由于季节和农业周期的影响，各个物种的种群数量变化呈现明显的周期性


摘要：系统生物学中，生态系统的演变问题一般呈现出影响因素多、情况复杂等性质；对于森林生态系统向农田生态系统的演变，由于案例少、数据精度差等问题，建立精确的数学模型并求解则更加困难。因此，能够使用随机微分方程来描述生态系统的演变历程，通过对不同物种之间的相互作用关系进行数学描述，并引入随机变量以模拟自然情况下的不确定性，从而更为准确地刻画变量随时间的演化规律。
对于底层的模型框架，基于随机Lokta-Volterra模型能够实现对森林转农田区域的真实模拟：物种的相互作用关系可以被建模为多个种群数量向量之间的运算，捕食、合作、竞争等关系以及周期影响因素则被建模为响应函数和影响系数的形式，并且引入人类决策因素，研究在不同决策下生态系统的演变过程，最后通过微分的方式得到种群数量的变化率。
由于随机微分方程的真解大多不可得到或极为复杂，采取数值模拟仿真的方式更加合适：使用Euler-Maruyama方法，能够有效地近似求解随机微分方程，并对各物种种群的变化进行追踪和可视化分析。最终，将模型的变化情况与现实案例进行对照分析，以获得一个科学、经济和可持续的发展策略。

参考文献：
[1] Hairer E, Wanner G. Solving Ordinary Differential Equations II[M]. Berlin: SpringerVerlag, 2010.
[2] Mao X. Stochastic Differential Equations and Applications[M]. Chichester: Horwood Publishing, 2007.
[3] Rudnicki R. Longtime behavior of a stochastic preypredator model[J]. Stochastic Processes and their Applications, 2003, 108(1): 93–107.
[4] Zuo W,Jiang D, Sun X,et al. Longtime behaviors of a stochastic cooperative LotkaVolterra system with distributed delay[J], Physica A, 2018, 506 : 542–559.、

关键字：系统生物学, Lokta-Volterra模型, 随机微分方程, 数值模拟, 算法